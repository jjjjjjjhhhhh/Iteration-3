{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.render = render;\nrequire(\"core-js/modules/es.array.join.js\");\nrequire(\"core-js/modules/es.string.ends-with.js\");\nvar _vue = require(\"vue\");\nvar _withScopeId = function _withScopeId(n) {\n  return (0, _vue.pushScopeId)(\"data-v-61a6e3fa\"), n = n(), (0, _vue.popScopeId)(), n;\n};\nvar _hoisted_1 = {\n  \"class\": \"center_view\"\n};\nvar _hoisted_2 = {\n  \"class\": \"list_search_view\"\n};\nvar _hoisted_3 = {\n  \"class\": \"search_view\"\n};\nvar _hoisted_4 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/(0, _vue.createElementVNode)(\"div\", {\n    \"class\": \"search_label\"\n  }, \" 专家姓名： \", -1 /* HOISTED */);\n});\nvar _hoisted_5 = {\n  \"class\": \"search_box\"\n};\nvar _hoisted_6 = {\n  \"class\": \"search_btn_view\"\n};\nvar _hoisted_7 = {\n  \"class\": \"btn_view\"\n};\nvar _hoisted_8 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/(0, _vue.createElementVNode)(\"i\", {\n    \"class\": \"iconfont icon-xinzeng4\"\n  }, null, -1 /* HOISTED */);\n});\nvar _hoisted_9 = {\n  key: 0,\n  \"class\": \"dataList\"\n};\nvar _hoisted_10 = {\n  \"class\": \"title\"\n};\nvar _hoisted_11 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/(0, _vue.createElementVNode)(\"div\", {\n    \"class\": \"title status-row\"\n  }, null, -1 /* HOISTED */);\n});\nvar _hoisted_12 = {\n  \"class\": \"btns\"\n};\nvar _hoisted_13 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/(0, _vue.createElementVNode)(\"i\", {\n    \"class\": \"iconfont icon-sousuo3\"\n  }, null, -1 /* HOISTED */);\n});\nvar _hoisted_14 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/(0, _vue.createElementVNode)(\"i\", {\n    \"class\": \"iconfont icon-xiugai4\"\n  }, null, -1 /* HOISTED */);\n});\nvar _hoisted_15 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/(0, _vue.createElementVNode)(\"i\", {\n    \"class\": \"iconfont icon-shanchu1\"\n  }, null, -1 /* HOISTED */);\n});\nvar _hoisted_16 = {\n  \"class\": \"chat-content\",\n  id: \"chat-content\"\n};\nvar _hoisted_17 = {\n  key: 0,\n  style: {\n    \"font-size\": \"12px\",\n    \"text-align\": \"center\",\n    \"margin\": \"4px 0\"\n  }\n};\nvar _hoisted_18 = {\n  key: 1,\n  \"class\": \"right-content\"\n};\nvar _hoisted_19 = {\n  key: 1,\n  controls: \"\",\n  style: {\n    \"width\": \"200px\",\n    \"height\": \"160px\"\n  }\n};\nvar _hoisted_20 = [\"src\"];\nvar _hoisted_21 = [\"src\"];\nvar _hoisted_22 = {\n  key: 2,\n  \"class\": \"left-content\"\n};\nvar _hoisted_23 = [\"src\"];\nvar _hoisted_24 = {\n  key: 1,\n  controls: \"\",\n  style: {\n    \"width\": \"200px\",\n    \"height\": \"160px\"\n  }\n};\nvar _hoisted_25 = [\"src\"];\nvar _hoisted_26 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/(0, _vue.createElementVNode)(\"div\", {\n    \"class\": \"clear-float\"\n  }, null, -1 /* HOISTED */);\n});\nvar _hoisted_27 = {\n  slot: \"footer\",\n  \"class\": \"dialog-footer\"\n};\nfunction render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_el_input = (0, _vue.resolveComponent)(\"el-input\");\n  var _component_el_button = (0, _vue.resolveComponent)(\"el-button\");\n  var _component_el_form = (0, _vue.resolveComponent)(\"el-form\");\n  var _component_el_image = (0, _vue.resolveComponent)(\"el-image\");\n  var _component_el_pagination = (0, _vue.resolveComponent)(\"el-pagination\");\n  var _component_el_alert = (0, _vue.resolveComponent)(\"el-alert\");\n  var _component_el_upload = (0, _vue.resolveComponent)(\"el-upload\");\n  var _component_el_dialog = (0, _vue.resolveComponent)(\"el-dialog\");\n  return (0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"div\", null, [(0, _vue.createElementVNode)(\"div\", _hoisted_1, [(0, _vue.createElementVNode)(\"div\", _hoisted_2, [(0, _vue.createVNode)(_component_el_form, {\n    model: $setup.searchQuery,\n    \"class\": \"search_form\"\n  }, {\n    \"default\": (0, _vue.withCtx)(function () {\n      return [(0, _vue.createElementVNode)(\"div\", _hoisted_3, [_hoisted_4, (0, _vue.createElementVNode)(\"div\", _hoisted_5, [(0, _vue.createVNode)(_component_el_input, {\n        \"class\": \"search_inp\",\n        modelValue: $setup.searchQuery.zhuanjiaxingming,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n          return $setup.searchQuery.zhuanjiaxingming = $event;\n        }),\n        placeholder: \"专家姓名\",\n        clearable: \"\"\n      }, null, 8 /* PROPS */, [\"modelValue\"])])]), (0, _vue.createElementVNode)(\"div\", _hoisted_6, [(0, _vue.createVNode)(_component_el_button, {\n        \"class\": \"search_btn\",\n        type: \"primary\",\n        onClick: _cache[1] || (_cache[1] = function ($event) {\n          return $setup.searchClick();\n        }),\n        size: \"small\"\n      }, {\n        \"default\": (0, _vue.withCtx)(function () {\n          return [(0, _vue.createTextVNode)(\"Search\")];\n        }),\n        _: 1 /* STABLE */\n      })])];\n    }),\n\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"model\"]), (0, _vue.createElementVNode)(\"div\", _hoisted_7, [$setup.btnAuth('jiankangzhuanjia', '新增') ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_button, {\n    key: 0,\n    \"class\": \"add_btn\",\n    type: \"success\",\n    onClick: $setup.addClick\n  }, {\n    \"default\": (0, _vue.withCtx)(function () {\n      return [_hoisted_8, (0, _vue.createTextVNode)(\" 新增 \")];\n    }),\n    _: 1 /* STABLE */\n  })) : (0, _vue.createCommentVNode)(\"v-if\", true)])]), $setup.btnAuth('jiankangzhuanjia', '查看') ? ((0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"div\", _hoisted_9, [((0, _vue.openBlock)(true), (0, _vue.createElementBlock)(_vue.Fragment, null, (0, _vue.renderList)($setup.list, function (item, index) {\n    return (0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"div\", {\n      \"class\": \"item\",\n      key: item.id\n    }, [item.touxiang ? ((0, _vue.openBlock)(), (0, _vue.createElementBlock)(_vue.Fragment, {\n      key: 0\n    }, [item.touxiang.substring(0, 4) == 'http' ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_image, {\n      key: 0,\n      \"preview-teleported\": \"\",\n      \"preview-src-list\": [item.touxiang.split(',')[0]],\n      src: item.touxiang.split(',')[0]\n    }, null, 8 /* PROPS */, [\"preview-src-list\", \"src\"])) : ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_image, {\n      key: 1,\n      \"preview-teleported\": \"\",\n      \"preview-src-list\": [_ctx.$config.url + item.touxiang.split(',')[0]],\n      src: _ctx.$config.url + item.touxiang.split(',')[0]\n    }, null, 8 /* PROPS */, [\"preview-src-list\", \"src\"]))], 64 /* STABLE_FRAGMENT */)) : (0, _vue.createCommentVNode)(\"v-if\", true), (0, _vue.createElementVNode)(\"div\", _hoisted_10, (0, _vue.toDisplayString)(item.zhuanjiaxingming), 1 /* TEXT */), _hoisted_11, (0, _vue.createElementVNode)(\"div\", _hoisted_12, [$setup.btnAuth('jiankangzhuanjia', '查看') ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_button, {\n      key: 0,\n      \"class\": \"view_btn\",\n      type: \"info\",\n      onClick: function onClick($event) {\n        return $setup.infoClick(item.id);\n      }\n    }, {\n      \"default\": (0, _vue.withCtx)(function () {\n        return [_hoisted_13, (0, _vue.createTextVNode)(\" 详情 \")];\n      }),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])) : (0, _vue.createCommentVNode)(\"v-if\", true), $setup.btnAuth('jiankangzhuanjia', '修改') ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_button, {\n      key: 1,\n      \"class\": \"edit_btn\",\n      type: \"primary\",\n      onClick: function onClick($event) {\n        return $setup.editClick(item.id);\n      }\n    }, {\n      \"default\": (0, _vue.withCtx)(function () {\n        return [_hoisted_14, (0, _vue.createTextVNode)(\" 修改 \")];\n      }),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])) : (0, _vue.createCommentVNode)(\"v-if\", true), $setup.btnAuth('jiankangzhuanjia', '删除') ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_button, {\n      key: 2,\n      \"class\": \"del_btn\",\n      type: \"danger\",\n      onClick: function onClick($event) {\n        return $setup.delClick(item.id);\n      }\n    }, {\n      \"default\": (0, _vue.withCtx)(function () {\n        return [_hoisted_15, (0, _vue.createTextVNode)(\" 删除 \")];\n      }),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])) : (0, _vue.createCommentVNode)(\"v-if\", true), $setup.btnAuth('jiankangzhuanjia', '私信') ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_button, {\n      key: 3,\n      \"class\": \"operate_btn\",\n      type: \"success\",\n      onClick: function onClick($event) {\n        return $setup.chatClick(item);\n      }\n    }, {\n      \"default\": (0, _vue.withCtx)(function () {\n        return [(0, _vue.createTextVNode)(\" 私信 \")];\n      }),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])) : (0, _vue.createCommentVNode)(\"v-if\", true)])]);\n  }), 128 /* KEYED_FRAGMENT */))])) : (0, _vue.createCommentVNode)(\"v-if\", true), (0, _vue.createVNode)(_component_el_pagination, {\n    background: \"\",\n    layout: $setup.layouts.join(','),\n    total: $setup.total,\n    \"page-size\": $setup.listQuery.limit,\n    \"current-page\": $setup.listQuery.page,\n    \"onUpdate:currentPage\": _cache[2] || (_cache[2] = function ($event) {\n      return $setup.listQuery.page = $event;\n    }),\n    \"prev-text\": \"Previous page\",\n    \"next-text\": \"Next page\",\n    \"hide-on-single-page\": false,\n    style: {},\n    \"page-sizes\": [10, 20, 30, 40, 50, 100],\n    onSizeChange: $setup.sizeChange,\n    onCurrentChange: $setup.currentChange\n  }, null, 8 /* PROPS */, [\"layout\", \"total\", \"page-size\", \"current-page\"])]), (0, _vue.createVNode)($setup[\"formModel\"], {\n    ref: \"formRef\",\n    onFormModelChange: $setup.formModelChange\n  }, null, 512 /* NEED_PATCH */), (0, _vue.createVNode)(_component_el_dialog, {\n    modelValue: $setup.chatVisible,\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = function ($event) {\n      return $setup.chatVisible = $event;\n    }),\n    onClose: $setup.clearChat,\n    title: $setup.nowname,\n    \"append-to-body\": true\n  }, {\n    \"default\": (0, _vue.withCtx)(function () {\n      return [(0, _vue.createElementVNode)(\"div\", _hoisted_16, [((0, _vue.openBlock)(true), (0, _vue.createElementBlock)(_vue.Fragment, null, (0, _vue.renderList)($setup.chatList, function (item, index) {\n        return (0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"div\", {\n          key: item.id\n        }, [index > 1 && $setup.moment($setup.chatList[index - 1].addtime).date() != $setup.moment(item.addtime).date() || index == 0 ? ((0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"div\", _hoisted_17, (0, _vue.toDisplayString)($setup.moment(item.addtime).format(\"MM-DD HH:mm\")), 1 /* TEXT */)) : (0, _vue.createCommentVNode)(\"v-if\", true), item.uid == $setup.user.id ? ((0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"div\", _hoisted_18, [item.format == 1 ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_alert, {\n          key: 0,\n          \"class\": \"text-content\",\n          title: item.content,\n          closable: false,\n          type: \"warning\"\n        }, null, 8 /* PROPS */, [\"title\"])) : item.content.endsWith('.mp4') ? ((0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"video\", _hoisted_19, [(0, _vue.createElementVNode)(\"source\", {\n          src: _ctx.$config.url + item.content\n        }, null, 8 /* PROPS */, _hoisted_20)])) : ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_image, {\n          key: 2,\n          fit: \"cover\",\n          src: item.content ? _ctx.$config.url + item.content : '',\n          style: {\n            \"width\": \"100px\",\n            \"height\": \"100px\"\n          },\n          \"preview-src-list\": [item.content ? _ctx.$config.url + item.content : '']\n        }, null, 8 /* PROPS */, [\"src\", \"preview-src-list\"])), (0, _vue.createElementVNode)(\"img\", {\n          src: $setup.avatar ? _ctx.$config.url + $setup.avatar : require('@/assets/img/avatar.png'),\n          alt: \"\",\n          style: {\n            \"width\": \"30px\",\n            \"border-radius\": \"50%\",\n            \"height\": \"30px\",\n            \"margin\": \"0 0 0 10px\",\n            \"flex-shrink\": \"0\",\n            \"object-fit\": \"cover\"\n          }\n        }, null, 8 /* PROPS */, _hoisted_21)])) : ((0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"div\", _hoisted_22, [(0, _vue.createElementVNode)(\"img\", {\n          src: $setup.nowfpic ? _ctx.$config.url + $setup.nowfpic : require('@/assets/img/avatar.png'),\n          alt: \"\",\n          style: {\n            \"width\": \"30px\",\n            \"border-radius\": \"50%\",\n            \"height\": \"30px\",\n            \"margin\": \"0 10px 0 0\",\n            \"flex-shrink\": \"0\",\n            \"object-fit\": \"cover\"\n          }\n        }, null, 8 /* PROPS */, _hoisted_23), item.format == 1 ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_alert, {\n          key: 0,\n          \"class\": \"text-content\",\n          title: item.content,\n          closable: false,\n          type: \"success\"\n        }, null, 8 /* PROPS */, [\"title\"])) : item.content.endsWith('.mp4') ? ((0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"video\", _hoisted_24, [(0, _vue.createElementVNode)(\"source\", {\n          src: _ctx.$config.url + item.content\n        }, null, 8 /* PROPS */, _hoisted_25)])) : ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_image, {\n          key: 2,\n          fit: \"cover\",\n          src: item.content ? _ctx.$config.url + item.content : '',\n          style: {\n            \"width\": \"100px\",\n            \"height\": \"100px\"\n          },\n          \"preview-src-list\": [item.content ? _ctx.$config.url + item.content : '']\n        }, null, 8 /* PROPS */, [\"src\", \"preview-src-list\"]))])), _hoisted_26]);\n      }), 128 /* KEYED_FRAGMENT */))]), (0, _vue.createElementVNode)(\"div\", _hoisted_27, [(0, _vue.createVNode)(_component_el_input, {\n        onKeydown: (0, _vue.withKeys)($setup.addChat, [\"enter\", \"native\"]),\n        modelValue: $setup.chatForm.content,\n        \"onUpdate:modelValue\": _cache[3] || (_cache[3] = function ($event) {\n          return $setup.chatForm.content = $event;\n        }),\n        placeholder: \"Enter内容\",\n        style: {\n          \"width\": \"calc(100% - 180px)\",\n          \"float\": \"left\"\n        }\n      }, null, 8 /* PROPS */, [\"onKeydown\", \"modelValue\"]), (0, _vue.createVNode)(_component_el_button, {\n        disabled: $setup.chatForm.content ? false : true,\n        type: \"primary\",\n        onClick: $setup.addChat\n      }, {\n        \"default\": (0, _vue.withCtx)(function () {\n          return [(0, _vue.createTextVNode)(\"发送\")];\n        }),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"disabled\"]), (0, _vue.createVNode)(_component_el_upload, {\n        style: {\n          \"display\": \"inline-block\",\n          \"margin\": \"0 0 0 6px\"\n        },\n        \"class\": \"upload-demo\",\n        action: $setup.uploadUrl,\n        \"on-success\": $setup.uploadSuccess,\n        \"show-file-list\": false,\n        accept: \"image/*,.mp4\"\n      }, {\n        \"default\": (0, _vue.withCtx)(function () {\n          return [(0, _vue.createVNode)(_component_el_button, {\n            type: \"success\"\n          }, {\n            \"default\": (0, _vue.withCtx)(function () {\n              return [(0, _vue.createTextVNode)(\"上传文件\")];\n            }),\n            _: 1 /* STABLE */\n          })];\n        }),\n\n        _: 1 /* STABLE */\n      })])];\n    }),\n\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\", \"title\"])]);\n}","map":{"version":3,"mappings":"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","names":["id","style","controls","slot","_hoisted_1","_hoisted_2","_component_el_form","model","$setup","_hoisted_3","_hoisted_4","_hoisted_5","_component_el_input","zhuanjiaxingming","placeholder","clearable","_hoisted_6","_component_el_button","type","onClick","size","_hoisted_7","_hoisted_8","_hoisted_9","_Fragment","item","index","key","touxiang","substring","_component_el_image","split","src","_ctx","url","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_component_el_pagination","background","layout","join","total","limit","page","onSizeChange","onCurrentChange","ref","onFormModelChange","_component_el_dialog","onClose","title","_hoisted_16","addtime","date","_hoisted_17","format","uid","_hoisted_18","_component_el_alert","content","closable","endsWith","_hoisted_19","fit","require","alt","_hoisted_22","_hoisted_24","_hoisted_26","_hoisted_27","onKeydown","disabled","_component_el_upload","action","accept"],"sourceRoot":"","sources":["C:\\Users\\24831\\Desktop\\Y\\毕业设计\\projectB\\迭代2\\manage_code\\src\\views\\jiankangzhuanjia\\list.vue"],"sourcesContent":["<template>\r\n\t<div>\r\n\t\t<div class=\"center_view\">\r\n\t\t\t<div class=\"list_search_view\">\r\n\t\t\t\t<el-form :model=\"searchQuery\" class=\"search_form\" >\r\n\t\t\t\t\t<div class=\"search_view\">\r\n\t\t\t\t\t\t<div class=\"search_label\">\r\n\t\t\t\t\t\t\t专家姓名：\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"search_box\">\r\n\t\t\t\t\t\t\t<el-input class=\"search_inp\" v-model=\"searchQuery.zhuanjiaxingming\" placeholder=\"专家姓名\"\r\n\t\t\t\t\t\t\t\tclearable>\r\n\t\t\t\t\t\t\t</el-input>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"search_btn_view\">\r\n\t\t\t\t\t\t<el-button class=\"search_btn\" type=\"primary\" @click=\"searchClick()\" size=\"small\">Search</el-button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-form>\r\n\t\t\t\t<div class=\"btn_view\">\r\n\t\t\t\t\t<el-button class=\"add_btn\" type=\"success\" @click=\"addClick\" v-if=\"btnAuth('jiankangzhuanjia','新增')\">\r\n\t\t\t\t\t\t<i class=\"iconfont icon-xinzeng4\"></i>\r\n\t\t\t\t\t\t新增\r\n\t\t\t\t\t</el-button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"dataList\"\r\n\t\t\t\t v-if=\"btnAuth('jiankangzhuanjia','查看')\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\"item\" v-for=\"(item,index) in list\" :key=\"item.id\">\r\n                    <template v-if=\"item.touxiang\">\r\n                        <el-image v-if=\"item.touxiang.substring(0,4)=='http'\" preview-teleported\r\n                                  :preview-src-list=\"[item.touxiang.split(',')[0]]\"\r\n                                  :src=\"item.touxiang.split(',')[0]\"></el-image>\r\n                        <el-image v-else preview-teleported\r\n                                  :preview-src-list=\"[$config.url+item.touxiang.split(',')[0]]\"\r\n                                  :src=\"$config.url+item.touxiang.split(',')[0]\">\r\n                        </el-image>\r\n                    </template>\r\n\t\t\t\t\t<div class=\"title\">{{item.zhuanjiaxingming}}</div>\r\n                    <div class=\"title status-row\">\r\n                    </div>\r\n\t\t\t\t\t<div class=\"btns\">\r\n\t\t\t\t\t\t<el-button class=\"view_btn\" type=\"info\" v-if=\" btnAuth('jiankangzhuanjia','查看')\" @click=\"infoClick(item.id)\">\r\n\t\t\t\t\t\t\t<i class=\"iconfont icon-sousuo3\"></i>\r\n\t\t\t\t\t\t\t详情\r\n\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t\t<el-button class=\"edit_btn\" type=\"primary\" @click=\"editClick(item.id)\" v-if=\" btnAuth('jiankangzhuanjia','修改')\">\r\n\t\t\t\t\t\t\t<i class=\"iconfont icon-xiugai4\"></i>\r\n\t\t\t\t\t\t\t修改\r\n\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t\t<el-button class=\"del_btn\" type=\"danger\" @click=\"delClick(item.id)\"  v-if=\"btnAuth('jiankangzhuanjia','删除')\">\r\n\t\t\t\t\t\t\t<i class=\"iconfont icon-shanchu1\"></i>\r\n\t\t\t\t\t\t\t删除\r\n\t\t\t\t\t\t</el-button>\r\n                        <el-button class=\"operate_btn\" v-if=\"btnAuth('jiankangzhuanjia','私信')\" type=\"success\" @click=\"chatClick(item)\">\r\n                          私信\r\n                        </el-button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<el-pagination\r\n\t\t\t\tbackground\r\n\t\t\t\t:layout=\"layouts.join(',')\"\r\n\t\t\t\t:total=\"total\"\r\n\t\t\t\t:page-size=\"listQuery.limit\"\r\n                v-model:current-page=\"listQuery.page\"\r\n\t\t\t\tprev-text=\"Previous page\"\r\n\t\t\t\tnext-text=\"Next page\"\r\n\t\t\t\t:hide-on-single-page=\"false\"\r\n\t\t\t\t:style='{}'\r\n\t\t\t\t:page-sizes=\"[10, 20, 30, 40, 50, 100]\"\r\n\t\t\t\t@size-change=\"sizeChange\"\r\n\t\t\t\t@current-change=\"currentChange\"  />\r\n\t\t</div>\r\n\t\t<formModel ref=\"formRef\" @formModelChange=\"formModelChange\"></formModel>\r\n        <el-dialog v-model=\"chatVisible\" @close=\"clearChat\" :title=\"nowname\" :append-to-body=\"true\">\r\n            <div class=\"chat-content\" id=\"chat-content\">\r\n                <div v-bind:key=\"item.id\" v-for=\"(item,index) in chatList\">\r\n                    <div v-if=\"index>1&&moment(chatList[index-1].addtime).date()!=moment(item.addtime).date()||index==0\"\r\n                         style=\"font-size: 12px;text-align: center;margin: 4px 0;\">\r\n                        {{moment(item.addtime).format(\"MM-DD HH:mm\")}}\r\n                    </div>\r\n                    <div v-if=\"item.uid==user.id\" class=\"right-content\">\r\n                        <el-alert v-if=\"item.format==1\" class=\"text-content\" :title=\"item.content\" :closable=\"false\"\r\n                                  type=\"warning\"></el-alert>\r\n                        <video v-else-if=\"item.content.endsWith('.mp4')\" controls style=\"width: 200px;height: 160px\">\r\n                            <source  :src=\"$config.url + item.content\">\r\n                        </video>\r\n                        <el-image v-else fit=\"cover\" :src=\"item.content?$config.url + item.content:''\"\r\n                                  style=\"width: 100px;height: 100px;\"\r\n                                  :preview-src-list=\"[item.content?$config.url + item.content:'']\"></el-image>\r\n                        <img :src=\"avatar?$config.url + avatar:require('@/assets/img/avatar.png')\" alt=\"\"\r\n                             style=\"width: 30px;border-radius: 50%;height: 30px;margin: 0 0 0 10px;flex-shrink: 0;object-fit: cover;\" />\r\n                    </div>\r\n                    <div v-else class=\"left-content\">\r\n                        <img :src=\"nowfpic?$config.url + nowfpic:require('@/assets/img/avatar.png')\" alt=\"\"\r\n                             style=\"width: 30px;border-radius: 50%;height: 30px;margin: 0 10px 0 0;flex-shrink: 0;object-fit: cover;\" />\r\n                        <el-alert v-if=\"item.format==1\" class=\"text-content\" :title=\"item.content\" :closable=\"false\"\r\n                                  type=\"success\"></el-alert>\r\n                        <video v-else-if=\"item.content.endsWith('.mp4')\" controls style=\"width: 200px;height: 160px\">\r\n                            <source  :src=\"$config.url + item.content\">\r\n                        </video>\r\n                        <el-image v-else fit=\"cover\" :src=\"item.content?$config.url + item.content:''\"\r\n                                  style=\"width: 100px;height: 100px;\"\r\n                                  :preview-src-list=\"[item.content?$config.url + item.content:'']\"></el-image>\r\n                    </div>\r\n                    <div class=\"clear-float\"></div>\r\n                </div>\r\n            </div>\r\n            <div slot=\"footer\" class=\"dialog-footer\">\r\n                <el-input @keydown.enter.native=\"addChat\" v-model=\"chatForm.content\" placeholder=\"Enter内容\"\r\n                          style=\"width: calc(100% - 180px);float: left;\">\r\n                </el-input>\r\n                <el-button :disabled=\"chatForm.content?false:true\" type=\"primary\" @click=\"addChat\">发送</el-button>\r\n                <el-upload style=\"display: inline-block;margin: 0 0 0 6px;\" class=\"upload-demo\" :action=\"uploadUrl\"\r\n                           :on-success=\"uploadSuccess\" :show-file-list=\"false\" accept=\"image/*,.mp4\">\r\n                    <el-button type=\"success\">上传文件</el-button>\r\n                </el-upload>\r\n            </div>\r\n        </el-dialog>\r\n\t</div>\r\n</template>\r\n<script setup>\r\n\timport axios from 'axios'\r\n    import moment from \"moment\"\r\n\timport {\r\n\t\treactive,\r\n\t\tref,\r\n\t\tgetCurrentInstance,\r\n\t\tnextTick,\r\n\t\tonMounted,\r\n\t\twatch,\r\n\t\tcomputed,\r\n\t} from 'vue'\r\n\timport {\r\n\t\tuseRoute,\r\n\t\tuseRouter\r\n\t} from 'vue-router'\r\n\timport {\r\n\t\tElMessageBox\r\n\t} from 'element-plus'\r\n\timport {\r\n\t\tuseStore\r\n\t} from 'vuex';\r\n\tconst store = useStore()\r\n\tconst user = computed(()=>store.getters['user/session'])\r\n\tconst avatar = ref(store.state.user.avatar)\r\n\tconst context = getCurrentInstance()?.appContext.config.globalProperties;\r\n\timport formModel from './formModel.vue'\r\n\t//基础信息\r\n\r\n\tconst tableName = 'jiankangzhuanjia'\r\n\tconst formName = '健康专家'\r\n\tconst route = useRoute()\r\n    const router = useRouter()\r\n\t//基础信息\r\n\tonMounted(()=>{\r\n\t})\r\n\t//列表数据\r\n\tconst list = ref(null)\r\n\tconst table = ref(null)\r\n\tconst listQuery = ref({\r\n\t\tpage: 1,\r\n\t\tlimit: 10,\r\n\t\tsort: 'id',\r\n\t\torder: 'desc'\r\n\t})\r\n\tconst searchQuery = ref({})\r\n\tconst selRows = ref([])\r\n\tconst listLoading = ref(false)\r\n\tconst listChange = (row) =>{\r\n\t\tnextTick(()=>{\r\n\t\t\t//table.value.clearSelection()\r\n\t\t\ttable.value.toggleRowSelection(row)\r\n\t\t})\r\n\t}\r\n\t//列表\r\n\tconst getList = () => {\r\n\t\tlistLoading.value = true\r\n\t\tlet params = JSON.parse(JSON.stringify(listQuery.value))\r\n\t\tparams['sort'] = 'id'\r\n\t\tparams['order'] = 'desc'\r\n\t\tif(searchQuery.value.zhuanjiaxingming&&searchQuery.value.zhuanjiaxingming!=''){\r\n\t\t\tparams['zhuanjiaxingming'] = '%' + searchQuery.value.zhuanjiaxingming + '%'\r\n\t\t}\r\n\t\tcontext.$http({\r\n\t\t\turl: `${tableName}/page`,\r\n\t\t\tmethod: 'get',\r\n\t\t\tparams: params\r\n\t\t}).then(res => {\r\n\t\t\tlistLoading.value = false\r\n\t\t\tlist.value = res.data.data.list\r\n\t\t\ttotal.value = Number(res.data.data.total)\r\n\t\t})\r\n\t}\r\n\t//删\r\n\tconst delClick = (id) => {\r\n\t\tlet ids = ref([])\r\n\t\tif (id) {\r\n\t\t\tids.value = [id]\r\n\t\t} else {\r\n\t\t\tif (selRows.value.length) {\r\n\t\t\t\tfor (let x in selRows.value) {\r\n\t\t\t\t\tids.value.push(selRows.value[x].id)\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t}\r\n\t\tElMessageBox.confirm(`Do you want to delete the selected item${formName}`, '提示', {\r\n\t\t\tconfirmButtonText: '是',\r\n\t\t\tcancelButtonText: '否',\r\n\t\t\ttype: 'warning',\r\n\t\t}).then(() => {\r\n\t\t\tcontext.$http({\r\n\t\t\t\turl: `${tableName}/delete`,\r\n\t\t\t\tmethod: 'post',\r\n\t\t\t\tdata: ids.value\r\n\t\t\t}).then(res => {\r\n\t\t\t\tcontext?.$toolUtil.message('Delete successfully', 'success',()=>{\r\n\t\t\t\t\tgetList()\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t}).catch(_ => {})\r\n\t}\r\n\t//多选\r\n\tconst handleSelectionChange = (e) => {\r\n\t\tselRows.value = e\r\n\t}\r\n\t//列表数据\r\n\t//分页\r\n\tconst total = ref(0)\r\n\tconst layouts = ref([\"total\",\"prev\",\"pager\",\"next\",\"sizes\",\"jumper\"])\r\n\tconst sizeChange = (size) => {\r\n\t\tlistQuery.value.limit = size\r\n\t\tgetList()\r\n\t}\r\n\tconst currentChange = (page) => {\r\n\t\tlistQuery.value.page = page\r\n\t\tgetList()\r\n\t}\r\n\t//分页\r\n\t//权限验证\r\n\tconst btnAuth = (e,a)=>{\r\n\t\treturn context?.$toolUtil.isAuth(e,a)\r\n\t}\r\n\t//Search\r\n\tconst searchClick = () => {\r\n\t\tlistQuery.value.page = 1\r\n\t\tgetList()\r\n\t}\r\n\t//表单\r\n\tconst formRef = ref(null)\r\n\tconst formModelChange=()=>{\r\n\t\tsearchClick()\r\n\t}\r\n\tconst addClick = ()=>{\r\n\t\tformRef.value.init()\r\n\t}\r\n\tconst editClick = (id=null)=>{\r\n\t\tif(id){\r\n\t\t\tformRef.value.init(id,'edit')\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif(selRows.value.length){\r\n\t\t\tformRef.value.init(selRows.value[0].id,'edit')\r\n\t\t}\r\n\t}\r\n\r\n\tconst infoClick = (id=null)=>{\r\n\t\tif(id){\r\n\t\t\tformRef.value.init(id,'info')\r\n\t\t}\r\n\t\telse if(selRows.value.length){\r\n\t\t\tformRef.value.init(selRows.value[0].id,'info')\r\n\t\t}\r\n\t}\r\n\t// 表单\r\n\t// 预览文件\r\n\tconst preClick = (file) =>{\r\n\t\tif(!file){\r\n\t\t\tcontext?.$toolUtil.message('文件不存在','error')\r\n\t\t}\r\n\t\twindow.open(context?.$config.url + file)\r\n\t}\r\n\t// 下载文件\r\n\tconst download = (file) => {\r\n\t\tif(!file){\r\n\t\t\tcontext?.$toolUtil.message('文件不存在','error')\r\n\t\t}\r\n\t\tlet arr = file.replace(new RegExp('file/', \"g\"), \"\")\r\n\t\taxios.get((location.href.split(context?.$config.name).length>1 ? location.href.split(context?.$config.name)[0] :'') + context?.$config.name + '/file/download?fileName=' + arr, {\r\n\t\t\theaders: {\r\n\t\t\t\ttoken: context?.$toolUtil.storageGet('Token')\r\n\t\t\t},\r\n\t\t\tresponseType: \"blob\"\r\n\t\t}).then(({\r\n\t\t\tdata\r\n\t\t}) => {\r\n\t\t\tconst binaryData = [];\r\n\t\t\tbinaryData.push(data);\r\n\t\t\tconst objectUrl = window.URL.createObjectURL(new Blob(binaryData, {\r\n\t\t\t\ttype: 'application/pdf;chartset=UTF-8'\r\n\t\t\t}))\r\n\t\t\tconst a = document.createElement('a')\r\n\t\t\ta.href = objectUrl\r\n\t\t\ta.download = arr\r\n\t\t\t// a.click()\r\n\t\t\t// 下面这个写法兼容火狐\r\n\t\t\ta.dispatchEvent(new MouseEvent('click', {\r\n\t\t\t\tbubbles: true,\r\n\t\t\t\tcancelable: true,\r\n\t\t\t\tview: window\r\n\t\t\t}))\r\n\t\t\twindow.URL.revokeObjectURL(data)\r\n\t\t})\r\n\t}\r\n    const chatVisible = ref(false)\r\n    const nowfid = ref(0)\r\n    const nowfpic = ref('')\r\n    const nowname = ref('')\r\n    const chatList = ref([])\r\n    const chatForm = ref({\r\n        content: ''\r\n    })\r\n    const chatTimer = ref(null)\r\n    const uploadUrl = context?.$config.url + 'file/upload'\r\n    const chatClick = (row) => {\r\n        if (row.id == user.value.id) {\r\n            context.$toolUtil.message('不能给自己发消息！','error')\r\n            return false\r\n        }\r\n        nowfid.value = row.id\r\n        if (row.touxiang) {\r\n            nowfpic.value = row.touxiang.split(',')[0]\r\n        } else if (row.headportrait) {\r\n            nowfpic.value = row.headportrait.split(',')[0]\r\n        }\r\n        if (row.zhuanjiazhanghao) {\r\n            nowname.value = row.zhuanjiazhanghao\r\n        }\r\n        scrollFlag.value = true\r\n        getChatList()\r\n        chatVisible.value = true\r\n    }\r\n    const scrollFlag = ref(true)\r\n    const getChatList = () => {\r\n        context.$http.get('chatmessage/mlist', {\r\n            params: {\r\n                page: 1,\r\n                limit: 1000,\r\n                uid: user.value.id,\r\n                fid: nowfid.value\r\n            }\r\n        }).then(res => {\r\n            if (res.data && res.data.code == 0) {\r\n                chatList.value = res.data.data.list\r\n                let div = document.getElementsByClassName('chat-content')[0]\r\n                setTimeout(() => {\r\n                    if (div){\r\n                        if(div.scrollTop+div.clientHeight==div.scrollHeight || scrollFlag.value){\r\n                            div.scrollTop = div.scrollHeight\r\n                            scrollFlag.value = false\r\n                        }\r\n                    }\r\n                }, 0)\r\n                chatTimer.value = setTimeout(() => {\r\n                    getChatList()\r\n                }, 5000)\r\n            }\r\n        })\r\n    }\r\n    const clearChat = () => {\r\n        clearTimeout(chatTimer.value)\r\n        chatList.value = []\r\n        getList()\r\n    }\r\n    const uploadSuccess = (res) => {\r\n        if (res.code == 0) {\r\n            clearTimeout(chatTimer.value)\r\n            context.$http.get('chatfriend/page', {\r\n                params: {\r\n                    uid: user.value.id,\r\n                    fid: nowfid.value,\r\n                }\r\n            }).then(obj => {\r\n                if (obj.data && obj.data.code == 0) {\r\n                    if (!obj.data.data.list.length) {\r\n                        context.$http.post('chatfriend/add', {\r\n                            uid: user.value.id,\r\n                            fid: nowfid.value,\r\n                            name: nowname.value,\r\n                            picture: nowfpic.value,\r\n                            type: 2,\r\n                            tablename: 'jiankangzhuanjia',\r\n                        }).then(res => {\r\n                            context.$http.post('chatfriend/add', {\r\n                                uid: nowfid.value,\r\n                                fid: user.value.id,\r\n                                type: 2,\r\n                                tablename: 'jiankangzhuanjia',\r\n                                name: context.$toolUtil.storageGet('adminName'),\r\n                                picture: avatar.value,\r\n                            }).then(res1 => {\r\n\r\n                            })\r\n                        })\r\n                    }\r\n                    context.$http.post('chatmessage/add', {\r\n                        uid: user.value.id,\r\n                        fid: nowfid.value,\r\n                        content: 'file/' + res.file,\r\n                        format: 2\r\n                    }).then(res2 => {\r\n                        chatForm.value = {\r\n                            content: ''\r\n                        }\r\n                        scrollFlag.value = true\r\n                        getChatList()\r\n                    })\r\n                }\r\n            })\r\n        }\r\n    }\r\n    const addChat = () => {\r\n        if(!chatForm.value.content.trim())return context.$message.error(\"消息内容不能为空\")\r\n        clearTimeout(chatTimer.value)\r\n        context.$http.get('chatfriend/page', {\r\n            params: {\r\n                uid: user.value.id,\r\n                fid: nowfid.value,\r\n            }\r\n        }).then(obj => {\r\n            if (obj.data && obj.data.code == 0) {\r\n                if (!obj.data.data.list.length) {\r\n                    context.$http.post('chatfriend/add', {\r\n                        uid: user.value.id,\r\n                        fid: nowfid.value,\r\n                        name: nowname.value,\r\n                        picture: nowfpic.value,\r\n                        type: 2,\r\n                        tablename:  'jiankangzhuanjia',\r\n                    }).then(res => {\r\n                        context.$http.post('chatfriend/add', {\r\n                            uid: nowfid.value,\r\n                            fid: user.value.id,\r\n                            type: 2,\r\n                            tablename: localStorage.getItem('sessionTable'),\r\n                            name: context.$toolUtil.storageGet('adminName'),\r\n                            picture: avatar.value,\r\n                        }).then(res1 => {\r\n\r\n                        })\r\n                    })\r\n                }\r\n                context.$http.post('chatmessage/add', {\r\n                    uid: user.value.id,\r\n                    fid: nowfid.value,\r\n                    content: chatForm.value.content,\r\n                    format: 1\r\n                }).then(res2 => {\r\n                    chatForm.value = {\r\n                        content: ''\r\n                    }\r\n                    scrollFlag.value = true\r\n                    getChatList()\r\n                })\r\n            }\r\n        })\r\n    }\r\n\t//初始化\r\n\tconst init = () => {\r\n\t\tgetList()\r\n\t}\r\n\tinit()\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n\r\n\t// operate盒子\r\n\t.list_search_view {\r\n\t\t// Search盒子\r\n\t\t.search_form {\r\n\t\t\t// 子盒子\r\n\t\t\t.search_view {\r\n\t\t\t\t// Searchlabel\r\n\t\t\t\t.search_label {\r\n\t\t\t\t}\r\n\t\t\t\t// Searchitem\r\n\t\t\t\t.search_box {\r\n\t\t\t\t\t// 输入框\r\n\t\t\t\t\t:deep(.search_inp) {\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Search按钮盒子\r\n\t\t\t.search_btn_view {\r\n\t\t\t\t// Search按钮\r\n\t\t\t\t.search_btn {\r\n\t\t\t\t}\r\n\t\t\t\t// Search按钮-悬浮\r\n\t\t\t\t.search_btn:hover {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t//头部按钮盒子\r\n\t\t.btn_view {\r\n\t\t\t// 其他\r\n\t\t\t:deep(.el-button--default){\r\n\t\t\t}\r\n\t\t\t// 其他-悬浮\r\n\t\t\t:deep(.el-button--default:hover){\r\n\t\t\t}\r\n\t\t\t// 新增\r\n\t\t\t:deep(.el-button--success){\r\n\t\t\t}\r\n\t\t\t// 新增-悬浮\r\n\t\t\t:deep(.el-button--success:hover){\r\n\t\t\t}\r\n\t\t\t// 删除\r\n\t\t\t:deep(.el-button--danger){\r\n\t\t\t}\r\n\t\t\t// 删除-悬浮\r\n\t\t\t:deep(.el-button--danger:hover){\r\n\t\t\t}\r\n\t\t\t// 统计\r\n\t\t\t:deep(.el-button--warning){\r\n\t\t\t}\r\n\t\t\t// 统计-悬浮\r\n\t\t\t:deep(.el-button--warning:hover){\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t// 表格样式\r\n\t.el-table {\r\n\t\t:deep(.el-table__header-wrapper) {\r\n\t\t\tthead {\r\n\t\t\t\ttr {\r\n\t\t\t\t\tth {\r\n\t\t\t\t\t\t.cell {\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t:deep(.el-table__body-wrapper) {\r\n\t\t\ttbody {\r\n\t\t\t\ttr {\r\n\t\t\t\t\ttd {\r\n\t\t\t\t\t\t.cell {\r\n\t\t\t\t\t\t\t// 编辑\r\n\t\t\t\t\t\t\t.el-button--primary {\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// 编辑-悬浮\r\n\t\t\t\t\t\t\t.el-button--primary:hover {\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// 详情\r\n\t\t\t\t\t\t\t.el-button--info {\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// 详情-悬浮\r\n\t\t\t\t\t\t\t.el-button--info:hover {\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// 删除\r\n\t\t\t\t\t\t\t.el-button--danger {\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// 删除-悬浮\r\n\t\t\t\t\t\t\t.el-button--danger:hover {\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// 跨表\r\n\t\t\t\t\t\t\t.el-button--success {\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// 跨表-悬浮\r\n\t\t\t\t\t\t\t.el-button--success:hover {\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// operate\r\n\t\t\t\t\t\t\t.el-button--warning {\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// operate-悬浮\r\n\t\t\t\t\t\t\t.el-button--warning:hover {\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\ttr:hover {\r\n\t\t\t\t\ttd {\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t// 分页器\r\n\t.el-pagination {\r\n\t\t// 总页码\r\n\t\t:deep(.el-pagination__total) {\r\n\t\t}\r\n\t\t// Previous page\r\n\t\t:deep(.btn-prev) {\r\n\t\t}\r\n\t\t// Next page\r\n\t\t:deep(.btn-next) {\r\n\t\t}\r\n\t\t// Previous page禁用\r\n\t\t:deep(.btn-prev:disabled) {\r\n\t\t}\r\n\t\t// Next page禁用\r\n\t\t:deep(.btn-next:disabled) {\r\n\t\t}\r\n\t\t// 页码\r\n\t\t:deep(.el-pager) {\r\n\t\t\t// 数字\r\n\t\t\t.number {\r\n\t\t\t}\r\n\t\t\t// 数字悬浮\r\n\t\t\t.number:hover {\r\n\t\t\t}\r\n\t\t\t// 选中\r\n\t\t\t.number.is-active {\r\n\t\t\t}\r\n\t\t}\r\n\t\t// sizes\r\n\t\t:deep(.el-pagination__sizes) {\r\n\t\t\tdisplay: inline-block;\r\n\t\t\tvertical-align: top;\r\n\t\t\tfont-size: 13px;\r\n\t\t\tline-height: 28px;\r\n\t\t\theight: 28px;\r\n\t\t\t.el-select {\r\n\t\t\t}\r\n\t\t}\r\n\t\t// 跳页\r\n\t\t:deep(.el-pagination__jump) {\r\n\t\t\t// 输入框\r\n\t\t\t.el-input {\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t.section-content {\r\n\t\tcursor: pointer;\r\n\t\tpadding: 20px;\r\n\t\tbox-shadow: 0px 4px 10px 0px rgba(0, 0, 0, 0.3);\r\n\t\tmargin: 0 0 20px;\r\n\t\tcolor: #333;\r\n\t\tbackground: #fff;\r\n\t\tdisplay: flex;\r\n\t\twidth: 100%;\r\n\t\tborder-color: #efefef;\r\n\t\tborder-width: 0;\r\n\t\talign-items: center;\r\n\t\tborder-style: solid;\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t.section-content:hover {\r\n\t\tcolor: #fff;\r\n\t\tbackground: #DF847F10;\r\n\t}\r\n\t.chat-content {\r\n\t\tpadding-bottom: 20px;\r\n\t\twidth: 100%;\r\n\t\tmargin-bottom: 10px;\r\n\t\tmax-height: 300px;\r\n\t\theight: 300px;\r\n\t\toverflow-y: scroll;\r\n\t\tborder: 1px solid #eeeeee;\r\n\t\tbackground: #fff;\r\n\r\n\t\t.left-content {\r\n\t\t\tfloat: left;\r\n\t\t\tmargin-bottom: 10px;\r\n\t\t\tpadding: 10px;\r\n\t\t\tmax-width: 80%;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t}\r\n\r\n\t\t.right-content {\r\n\t\t\tfloat: right;\r\n\t\t\tmargin-bottom: 10px;\r\n\t\t\tpadding: 10px;\r\n\t\t\tmax-width: 80%;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t}\r\n\t}\r\n\r\n\t.clear-float {\r\n\t\tclear: both;\r\n\t}\r\n\t.noList {\r\n\t\tcolor: #9e9e9e;\r\n\t\twidth: 100%;\r\n\t\ttext-align: center;\r\n\t\tpadding: 60px 0;\r\n\t}\r\n    .status-row{\r\n        display:flex;\r\n        gap: 6px;\r\n    }\r\n</style>\r\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}