{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.render = render;\nvar _vue = require(\"vue\");\nvar _hoisted_1 = {\n  style: {\n    \"width\": \"100%\",\n    \"height\": \"100%\"\n  }\n};\nvar _hoisted_2 = [\"src\"];\nvar _hoisted_3 = {\n  \"class\": \"el-upload-list__item-actions\"\n};\nvar _hoisted_4 = [\"onClick\"];\nvar _hoisted_5 = [\"onClick\"];\nvar _hoisted_6 = {\n  \"class\": \"el-upload__tip\"\n};\nvar _hoisted_7 = /*#__PURE__*/(0, _vue.createElementVNode)(\"div\", {\n  \"class\": \"el-upload__text\"\n}, [/*#__PURE__*/(0, _vue.createTextVNode)(\" 将文件拖到此处，或\"), /*#__PURE__*/(0, _vue.createElementVNode)(\"em\", null, \"点击上传\")], -1 /* HOISTED */);\nvar _hoisted_8 = {\n  \"class\": \"el-upload__tip\"\n};\nvar _hoisted_9 = [\"src\"];\nfunction render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_Plus = (0, _vue.resolveComponent)(\"Plus\");\n  var _component_el_icon = (0, _vue.resolveComponent)(\"el-icon\");\n  var _component_zoom_in = (0, _vue.resolveComponent)(\"zoom-in\");\n  var _component_Delete = (0, _vue.resolveComponent)(\"Delete\");\n  var _component_el_upload = (0, _vue.resolveComponent)(\"el-upload\");\n  var _component_upload_filled = (0, _vue.resolveComponent)(\"upload-filled\");\n  var _component_el_dialog = (0, _vue.resolveComponent)(\"el-dialog\");\n  return (0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"div\", null, [$setup.type == 'img' ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_upload, {\n    key: 0,\n    \"class\": \"img-uploader\",\n    action: $setup.uploadUrl,\n    \"list-type\": \"picture-card\",\n    limit: $setup.limit,\n    multiple: $setup.multiple,\n    \"file-list\": $setup.fileList,\n    \"onUpdate:fileList\": _cache[0] || (_cache[0] = function ($event) {\n      return $setup.fileList = $event;\n    }),\n    \"on-success\": $setup.uploadSuccess,\n    \"on-exceed\": $setup.uploadExceed,\n    disabled: $setup.disabled,\n    headers: $setup.uploadHeaders,\n    accept: \"image/*\"\n  }, (0, _vue.createSlots)({\n    file: (0, _vue.withCtx)(function (_ref) {\n      var file = _ref.file;\n      return [(0, _vue.createElementVNode)(\"div\", _hoisted_1, [(0, _vue.createElementVNode)(\"img\", {\n        \"class\": \"el-upload-list__item-thumbnail\",\n        src: file.url,\n        alt: \"\",\n        style: {\n          \"object-fit\": \"cover\"\n        }\n      }, null, 8 /* PROPS */, _hoisted_2), (0, _vue.createElementVNode)(\"span\", _hoisted_3, [(0, _vue.createElementVNode)(\"span\", {\n        \"class\": \"el-upload-list__item-preview\",\n        onClick: function onClick($event) {\n          return $setup.handlePictureCardPreview(file);\n        }\n      }, [(0, _vue.createVNode)(_component_el_icon, null, {\n        \"default\": (0, _vue.withCtx)(function () {\n          return [(0, _vue.createVNode)(_component_zoom_in)];\n        }),\n        _: 1 /* STABLE */\n      })], 8 /* PROPS */, _hoisted_4), !$setup.disabled ? ((0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"span\", {\n        key: 0,\n        \"class\": \"el-upload-list__item-delete\",\n        onClick: function onClick($event) {\n          return $setup.handleRemove(file);\n        }\n      }, [(0, _vue.createVNode)(_component_el_icon, null, {\n        \"default\": (0, _vue.withCtx)(function () {\n          return [(0, _vue.createVNode)(_component_Delete)];\n        }),\n        _: 1 /* STABLE */\n      })], 8 /* PROPS */, _hoisted_5)) : (0, _vue.createCommentVNode)(\"v-if\", true)])])];\n    }),\n    \"default\": (0, _vue.withCtx)(function () {\n      return [(0, _vue.createVNode)(_component_el_icon, null, {\n        \"default\": (0, _vue.withCtx)(function () {\n          return [(0, _vue.createVNode)(_component_Plus)];\n        }),\n        _: 1 /* STABLE */\n      })];\n    }),\n\n    _: 2 /* DYNAMIC */\n  }, [!$setup.disabled ? {\n    name: \"tip\",\n    fn: (0, _vue.withCtx)(function () {\n      return [(0, _vue.createElementVNode)(\"div\", _hoisted_6, (0, _vue.toDisplayString)($setup.tips), 1 /* TEXT */)];\n    }),\n\n    key: \"0\"\n  } : undefined]), 1032 /* PROPS, DYNAMIC_SLOTS */, [\"action\", \"limit\", \"multiple\", \"file-list\", \"disabled\", \"headers\"])) : ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_upload, {\n    key: 1,\n    \"class\": \"upload-demo\",\n    drag: \"\",\n    action: $setup.uploadUrl,\n    headers: $setup.uploadHeaders,\n    limit: $setup.limit,\n    multiple: $setup.multiple,\n    \"file-list\": $setup.fileList,\n    \"onUpdate:fileList\": _cache[1] || (_cache[1] = function ($event) {\n      return $setup.fileList = $event;\n    }),\n    \"on-preview\": $setup.uploadPreview,\n    \"on-success\": $setup.uploadSuccess,\n    \"on-error\": $setup.uploadError,\n    \"on-exceed\": $setup.uploadExceed,\n    \"on-remove\": $setup.handleRemove,\n    disabled: $setup.disabled\n  }, {\n    tip: (0, _vue.withCtx)(function () {\n      return [(0, _vue.createElementVNode)(\"div\", _hoisted_8, (0, _vue.toDisplayString)($setup.tips), 1 /* TEXT */)];\n    }),\n\n    \"default\": (0, _vue.withCtx)(function () {\n      return [(0, _vue.createVNode)(_component_el_icon, {\n        \"class\": \"el-icon--upload\"\n      }, {\n        \"default\": (0, _vue.withCtx)(function () {\n          return [(0, _vue.createVNode)(_component_upload_filled)];\n        }),\n        _: 1 /* STABLE */\n      }), _hoisted_7];\n    }),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"action\", \"headers\", \"limit\", \"multiple\", \"file-list\", \"disabled\"])), (0, _vue.createVNode)(_component_el_dialog, {\n    modelValue: $setup.dialogVisible,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = function ($event) {\n      return $setup.dialogVisible = $event;\n    }),\n    width: \"60%\"\n  }, {\n    \"default\": (0, _vue.withCtx)(function () {\n      return [(0, _vue.createElementVNode)(\"img\", {\n        \"w-full\": \"\",\n        src: $setup.dialogImageUrl,\n        alt: \"Preview Image\",\n        style: {\n          \"width\": \"100%\"\n        }\n      }, null, 8 /* PROPS */, _hoisted_9)];\n    }),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"])]);\n}","map":{"version":3,"mappings":";;;;;;;;;EASSA,KAAiC,EAAjC;IAAA;IAAA;EAAA;AAAiC;;;EAE/B,SAAM;AAA8B;;;;EAetC,SAAM;AAAgB;8BAW5B,6BAEM;EAFD,SAAM;AAAiB,2CAAC,YACnB,6CAAa,YAAT,MAAI;;EAGZ,SAAM;AAAgB;;;;;;;;;;gCAxC9B,6BAgDM,cA/CYC,WAAI,oCAArB,sBA4BYC;;IA5BkB,SAAM,cAAc;IAAEC,MAAM,EAAEF,gBAAS;IAAE,WAAS,EAAC,cAAc;IAAEG,KAAK,EAAEH,YAAK;IAAGI,QAAQ,EAAEJ,eAAQ;IACzH,WAAS,EAAEA,eAAQ;;aAARA,eAAQ;IAAA;IAAG,YAAU,EAAEA,oBAAa;IAAG,WAAS,EAAEA,mBAAY;IAAGK,QAAQ,EAAEL,eAAQ;IACrGM,OAAO,EAAEN,oBAAa;IAAEO,MAAM,EAAC;;IAIrBC,IAAI,oBACd;MAAA,IADkBA,IAAI,QAAJA,IAAI;MAAA,QACtB,6BAcM,OAdNC,UAcM,GAbL,6BAAgG;QAA3F,SAAM,gCAAgC;QAAEC,GAAG,EAAEF,IAAI,CAACG,GAAG;QAAEC,GAAG,EAAC,EAAE;QAACb,KAA0B,EAA1B;UAAA;QAAA;2CACnE,6BAWO,QAXPc,UAWO,GAVN,6BAIO;QAJD,SAAM,8BAA8B;QAAEC,OAAK;UAAA,OAAEd,+BAAwB,CAACQ,IAAI;QAAA;UAC/E,sBAEUO;qCADT;UAAA,OAAW,CAAX,sBAAWC;;;wCAGAhB,eAAQ,2BAArB,6BAIO;;QAJgB,SAAM,6BAA6B;QAAEc,OAAK;UAAA,OAAEd,mBAAY,CAACQ,IAAI;QAAA;UACnF,sBAEUO;qCADT;UAAA,OAAU,CAAV,sBAAUE;;;;;iCAdf;MAAA,OAEU,CAFV,sBAEUF;qCADT;UAAA,OAAQ,CAAR,sBAAQG;;;;;;;OAmBalB,eAAQ;UAAnB,KAAG;0BACb;MAAA,OAEM,CAFN,6BAEM,OAFNmB,UAEM,4BADHnB,WAAI;;;;oJAIT,sBAcYC;;IAdM,SAAM,aAAa;IAACmB,IAAI,EAAJ,EAAI;IAAElB,MAAM,EAAEF,gBAAS;IAAGM,OAAO,EAAEN,oBAAa;IAAGG,KAAK,EAAEH,YAAK;IACnGI,QAAQ,EAAEJ,eAAQ;IAAU,WAAS,EAAEA,eAAQ;;aAARA,eAAQ;IAAA;IAAG,YAAU,EAAEA,oBAAa;IAC3E,YAAU,EAAEA,oBAAa;IAAG,UAAQ,EAAEA,kBAAW;IAAG,WAAS,EAAEA,mBAAY;IAAG,WAAS,EAAEA,mBAAY;IAAGK,QAAQ,EAAEL;;IAOxGqB,GAAG,oBACb;MAAA,OAEM,CAFN,6BAEM,OAFNC,UAEM,4BADHtB,WAAI;;;iCARR;MAAA,OAEU,CAFV,sBAEUe;QAFD,SAAM;MAAiB;qCAC/B;UAAA,OAAiB,CAAjB,sBAAiBQ;;;UAElBC,UAEM;;;2FAOP,sBAEYC;gBAFQzB,oBAAa;;aAAbA,oBAAa;IAAA;IAAE0B,KAAK,EAAC;;iCACxC;MAAA,OAA6E,CAA7E,6BAA6E;QAAxE,QAAM,EAAN,EAAM;QAAEhB,GAAG,EAAEV,qBAAc;QAAEY,GAAG,EAAC,eAAe;QAACb,KAAoB,EAApB;UAAA;QAAA","names":["style","$setup","_component_el_upload","action","limit","multiple","disabled","headers","accept","file","_hoisted_1","src","url","alt","_hoisted_3","onClick","_component_el_icon","_component_zoom_in","_component_Delete","_component_Plus","_hoisted_6","drag","tip","_hoisted_8","_component_upload_filled","_hoisted_7","_component_el_dialog","width"],"sourceRoot":"","sources":["C:\\Users\\24831\\Desktop\\Y\\毕业设计\\projectB\\迭代2\\manage_code\\src\\components\\common\\upload.vue"],"sourcesContent":["<template>\r\n\t<div>\r\n\t\t<el-upload v-if=\"type=='img'\" class=\"img-uploader\" :action=\"uploadUrl\" list-type=\"picture-card\" :limit=\"limit\" :multiple=\"multiple\"\r\n\t\t\tv-model:file-list=\"fileList\" :on-success=\"uploadSuccess\" :on-exceed=\"uploadExceed\" :disabled=\"disabled\"\r\n\t\t\t:headers=\"uploadHeaders\" accept=\"image/*\">\r\n\t\t\t<el-icon>\r\n\t\t\t\t<Plus />\r\n\t\t\t</el-icon>\r\n\t\t\t<template #file=\"{ file }\">\r\n\t\t\t\t<div style=\"width: 100%;height: 100%;\">\r\n\t\t\t\t\t<img class=\"el-upload-list__item-thumbnail\" :src=\"file.url\" alt=\"\" style=\"object-fit: cover;\" />\r\n\t\t\t\t\t<span class=\"el-upload-list__item-actions\">\r\n\t\t\t\t\t\t<span class=\"el-upload-list__item-preview\" @click=\"handlePictureCardPreview(file)\">\r\n\t\t\t\t\t\t\t<el-icon>\r\n\t\t\t\t\t\t\t\t<zoom-in />\r\n\t\t\t\t\t\t\t</el-icon>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<span v-if=\"!disabled\" class=\"el-upload-list__item-delete\" @click=\"handleRemove(file)\">\r\n\t\t\t\t\t\t\t<el-icon>\r\n\t\t\t\t\t\t\t\t<Delete />\r\n\t\t\t\t\t\t\t</el-icon>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\t\t\t</template>\r\n\t\t\t<template #tip v-if=\"!disabled\">\r\n\t\t\t\t<div class=\"el-upload__tip\">\r\n\t\t\t\t\t{{tips}}\r\n\t\t\t\t</div>\r\n\t\t\t</template>\r\n\t\t</el-upload>\r\n\t\t<el-upload v-else class=\"upload-demo\" drag :action=\"uploadUrl\" :headers=\"uploadHeaders\" :limit=\"limit\"\r\n\t\t\t:multiple=\"multiple\" v-model:file-list=\"fileList\" :on-preview=\"uploadPreview\" multiple\r\n\t\t\t:on-success=\"uploadSuccess\" :on-error=\"uploadError\" :on-exceed=\"uploadExceed\" :on-remove=\"handleRemove\" :disabled=\"disabled\">\r\n\t\t\t<el-icon class=\"el-icon--upload\">\r\n\t\t\t\t<upload-filled />\r\n\t\t\t</el-icon>\r\n\t\t\t<div class=\"el-upload__text\">\r\n\t\t\t\t将文件拖到此处，或<em>点击上传</em>\r\n\t\t\t</div>\r\n\t\t\t<template #tip>\r\n\t\t\t\t<div class=\"el-upload__tip\">\r\n\t\t\t\t\t{{tips}}\r\n\t\t\t\t</div>\r\n\t\t\t</template>\r\n\t\t</el-upload>\r\n\t\t<el-dialog v-model=\"dialogVisible\" width=\"60%\">\r\n\t\t\t<img w-full :src=\"dialogImageUrl\" alt=\"Preview Image\" style=\"width: 100%;\" />\r\n\t\t</el-dialog>\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref,\r\n\t\tgetCurrentInstance,\r\n\t\ttoRefs,\r\n\t\tdefineEmits,\r\n\t\twatch\r\n\t} from 'vue'\r\n\tconst context = getCurrentInstance()?.appContext.config.globalProperties;\r\n\tconst emit = defineEmits(['change'])\r\n\t//props\r\n\tconst props = defineProps({\r\n\t\taction: String,\r\n\t\tlimit: {\r\n\t\t\ttype: Number,\r\n\t\t\tdefault: 3\r\n\t\t},\r\n\t\tmultiple: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t},\r\n\t\tfileUrls: String,\r\n\t\ttip: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: '请上传'\r\n\t\t},\r\n\t\ttype: {\r\n\t\t\ttype: String,\r\n\t\t\tdefault: 'img'\r\n\t\t},\r\n\t\tdisabled: {\r\n\t\t\ttype: Boolean,\r\n\t\t\tdefault: false\r\n\t\t}\r\n\t})\r\n\t//data\r\n\tconst tips = ref('请上传')\r\n\tconst uploadUrl = ref('')\r\n\tconst fileList = ref([])\r\n\tconst fileUrlList = ref([])\r\n\tconst {\r\n\t\taction,\r\n\t\tfileUrls,\r\n\t\tlimit,\r\n\t\tmultiple,\r\n\t\ttip,\r\n\t\ttype,\r\n\t\tdisabled\r\n\t} = toRefs(props)\r\n\tconst dialogImageUrl = ref('')\r\n\tconst dialogVisible = ref(false)\r\n\tconst uploadHeaders = ref({})\r\n\r\n\twatch(fileUrls, () => {\r\n\t\tinit()\r\n\t})\r\n\t// // methods\r\n\r\n\t//移除\r\n\tconst handleRemove = (e) => {\r\n\t\tfileUrlList.value.splice(e.uid - 1, 1)\r\n\t\tfileUrlsChange(fileUrlList.value)\r\n\t\temit('change', fileUrlList.value.join(','))\r\n\t}\r\n\t//查看图片\r\n\tconst handlePictureCardPreview = (e) => {\r\n\t\tdialogImageUrl.value = e.url\r\n\t\tdialogVisible.value = true\r\n\t}\r\n\t//成功回调\r\n\tconst uploadSuccess = (e, file, fileList) => {\r\n\t\tfileUrlList.value.push(\"file/\" + e.file)\r\n\t\tfileUrlsChange(fileUrlList.value)\r\n\t\temit('change', fileUrlList.value.join(','))\r\n\t}\r\n\tconst uploadError = (e) => {\r\n\t\tcontext?.$toolUtil.message('上传失败', 'error')\r\n\t}\r\n\tconst uploadPreview = (e) => {\r\n\t\twindow.open(e.url)\r\n\t}\r\n\t//处理上传图片\r\n\tconst fileUrlsChange = (list) => {\r\n\t\tvar token = context?.$toolUtil.storageGet(\"token\");\r\n\t\tvar list1 = []\r\n\t\tvar list2 = []\r\n\t\tlist.forEach(function(item, index) {\r\n\t\t\tvar url = item.split(\"?\")[0];\r\n\t\t\tvar url1 = ''\r\n\t\t\tif (!url.startsWith(\"http\")) {\r\n\t\t\t\turl1 = context?.$config.url + url\r\n\t\t\t}\r\n\t\t\tvar name = item.match(/(?<=\\/)(\\w|\\W)+$/)[0];\r\n\t\t\tvar file = {\r\n\t\t\t\tname: name,\r\n\t\t\t\turl: url1 + \"?token=\" + token,\r\n\t\t\t\tuid: index + 1\r\n\t\t\t};\r\n\t\t\tlist1.push(file);\r\n\t\t\tlist2.push(url);\r\n\t\t});\r\n\t\tfileList.value = list1;\r\n\t\tfileUrlList.value = list2;\r\n\t}\r\n\t//超出数量\r\n\tconst uploadExceed = () => {\r\n\t\tcontext?.$toolUtil.message(`最多上传${limit.value}个文件`, 'error')\r\n\t}\r\n\t//created\r\n\tconst init = () => {\r\n\t\tuploadUrl.value = context?.$config.name + '/' + action.value\r\n\t\tuploadHeaders.value = {\r\n\t\t\t'Token': context?.$toolUtil.storageGet(\"Token\")\r\n\t\t}\r\n\t\tif (tip.value) {\r\n\t\t\ttips.value = tip.value\r\n\t\t}\r\n\t\tlet list = []\r\n\t\tif (fileUrls.value) {\r\n\t\t\tlist = fileUrls.value.split(',')\r\n\t\t}\r\n\t\tfileUrlsChange(list)\r\n\t}\r\n\tinit()\r\n</script>\r\n\r\n<style>\r\n\t.el-upload__tip {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: flex-start;\r\n\t}\r\n\t.el-upload-list.is-disabled .el-upload--picture-card{\r\n\t\tdisplay: none;\r\n\t}\r\n\t.el-upload-list__item-actions {\r\n\t\t--color: #fff;\r\n\t}\r\n</style>"]},"metadata":{},"sourceType":"script","externalDependencies":[]}