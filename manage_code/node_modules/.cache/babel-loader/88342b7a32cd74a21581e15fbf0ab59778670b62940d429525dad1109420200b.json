{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.render = render;\nrequire(\"core-js/modules/es.array.join.js\");\nrequire(\"core-js/modules/es.string.ends-with.js\");\nvar _vue = require(\"vue\");\nvar _withScopeId = function _withScopeId(n) {\n  return (0, _vue.pushScopeId)(\"data-v-1e52d9cb\"), n = n(), (0, _vue.popScopeId)(), n;\n};\nvar _hoisted_1 = {\n  \"class\": \"center_view\"\n};\nvar _hoisted_2 = {\n  \"class\": \"chat-content\"\n};\nvar _hoisted_3 = {\n  key: 0,\n  \"class\": \"chat_time\"\n};\nvar _hoisted_4 = {\n  key: 1,\n  \"class\": \"left-content\"\n};\nvar _hoisted_5 = {\n  key: 1,\n  controls: \"\",\n  style: {\n    \"width\": \"200px\",\n    \"height\": \"160px\"\n  }\n};\nvar _hoisted_6 = [\"src\"];\nvar _hoisted_7 = {\n  key: 2,\n  \"class\": \"right-content\"\n};\nvar _hoisted_8 = {\n  key: 1,\n  controls: \"\",\n  style: {\n    \"width\": \"200px\",\n    \"height\": \"160px\"\n  }\n};\nvar _hoisted_9 = [\"src\"];\nvar _hoisted_10 = /*#__PURE__*/_withScopeId(function () {\n  return /*#__PURE__*/(0, _vue.createElementVNode)(\"div\", {\n    \"class\": \"clear-float\"\n  }, null, -1 /* HOISTED */);\n});\nvar _hoisted_11 = {\n  \"class\": \"input_box\"\n};\nvar _hoisted_12 = {\n  key: 0,\n  \"class\": \"upload_box\"\n};\nvar _hoisted_13 = {\n  \"class\": \"save_box\"\n};\nfunction render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_el_table_column = (0, _vue.resolveComponent)(\"el-table-column\");\n  var _component_el_tag = (0, _vue.resolveComponent)(\"el-tag\");\n  var _component_el_button = (0, _vue.resolveComponent)(\"el-button\");\n  var _component_el_table = (0, _vue.resolveComponent)(\"el-table\");\n  var _component_el_pagination = (0, _vue.resolveComponent)(\"el-pagination\");\n  var _component_el_alert = (0, _vue.resolveComponent)(\"el-alert\");\n  var _component_el_image = (0, _vue.resolveComponent)(\"el-image\");\n  var _component_el_input = (0, _vue.resolveComponent)(\"el-input\");\n  var _component_el_upload = (0, _vue.resolveComponent)(\"el-upload\");\n  var _component_el_form = (0, _vue.resolveComponent)(\"el-form\");\n  var _component_el_dialog = (0, _vue.resolveComponent)(\"el-dialog\");\n  var _directive_loading = (0, _vue.resolveDirective)(\"loading\");\n  return (0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"div\", null, [(0, _vue.createElementVNode)(\"div\", _hoisted_1, [(0, _vue.withDirectives)(((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_table, {\n    data: $setup.list,\n    border: \"\",\n    stripe: false\n  }, {\n    \"default\": (0, _vue.withCtx)(function () {\n      return [(0, _vue.createVNode)(_component_el_table_column, {\n        prop: \"ask\",\n        resizable: true,\n        sortable: true,\n        align: \"left\",\n        \"header-align\": \"left\",\n        label: \"new message\"\n      }, {\n        \"default\": (0, _vue.withCtx)(function (scope) {\n          return [(0, _vue.createTextVNode)((0, _vue.toDisplayString)(scope.row.ask), 1 /* TEXT */)];\n        }),\n\n        _: 1 /* STABLE */\n      }), (0, _vue.createVNode)(_component_el_table_column, {\n        prop: \"ask\",\n        resizable: true,\n        sortable: true,\n        align: \"left\",\n        \"header-align\": \"left\",\n        label: \"state\"\n      }, {\n        \"default\": (0, _vue.withCtx)(function (scope) {\n          return [scope.row.isreply == 1 ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_tag, {\n            key: 0,\n            type: \"success\"\n          }, {\n            \"default\": (0, _vue.withCtx)(function () {\n              return [(0, _vue.createTextVNode)(\"No response received\")];\n            }),\n            _: 1 /* STABLE */\n          })) : (0, _vue.createCommentVNode)(\"v-if\", true), scope.row.isreply == 0 ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_tag, {\n            key: 1,\n            type: \"info\"\n          }, {\n            \"default\": (0, _vue.withCtx)(function () {\n              return [(0, _vue.createTextVNode)(\"Replied\")];\n            }),\n            _: 1 /* STABLE */\n          })) : (0, _vue.createCommentVNode)(\"v-if\", true)];\n        }),\n        _: 1 /* STABLE */\n      }), (0, _vue.createVNode)(_component_el_table_column, {\n        prop: \"ask\",\n        resizable: true,\n        sortable: true,\n        align: \"left\",\n        \"header-align\": \"left\",\n        label: \"operate\"\n      }, {\n        \"default\": (0, _vue.withCtx)(function (scope) {\n          return [(0, _vue.createVNode)(_component_el_button, {\n            \"class\": \"edit_btn\",\n            type: \"primary\",\n            onClick: function onClick($event) {\n              return $setup.replyClick(scope.row);\n            }\n          }, {\n            \"default\": (0, _vue.withCtx)(function () {\n              return [(0, _vue.createTextVNode)(\"Reply\")];\n            }),\n            _: 2 /* DYNAMIC */\n          }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])];\n        }),\n        _: 1 /* STABLE */\n      })];\n    }),\n\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"data\"])), [[_directive_loading, $setup.listLoading]]), (0, _vue.createVNode)(_component_el_pagination, {\n    background: \"\",\n    layout: $setup.layouts.join(','),\n    total: $setup.total,\n    \"page-size\": $setup.listQuery.limit,\n    \"current-page\": $setup.listQuery.page,\n    \"onUpdate:currentPage\": _cache[0] || (_cache[0] = function ($event) {\n      return $setup.listQuery.page = $event;\n    }),\n    \"prev-text\": \"Previous page\",\n    \"next-text\": \"Next page\",\n    \"hide-on-single-page\": false,\n    style: {},\n    onSizeChange: $setup.sizeChange,\n    onCurrentChange: $setup.currentChange\n  }, null, 8 /* PROPS */, [\"layout\", \"total\", \"page-size\", \"current-page\"]), (0, _vue.createVNode)(_component_el_dialog, {\n    modelValue: $setup.formVisible,\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = function ($event) {\n      return $setup.formVisible = $event;\n    }),\n    title: \"Reply\",\n    width: \"70%\",\n    \"destroy-on-close\": \"\",\n    onClose: $setup.delTimer\n  }, {\n    \"default\": (0, _vue.withCtx)(function () {\n      return [(0, _vue.createVNode)(_component_el_form, {\n        ref: \"formRef\",\n        model: $setup.form,\n        \"class\": \"chat_view\"\n      }, {\n        \"default\": (0, _vue.withCtx)(function () {\n          return [(0, _vue.createElementVNode)(\"div\", _hoisted_2, [((0, _vue.openBlock)(true), (0, _vue.createElementBlock)(_vue.Fragment, null, (0, _vue.renderList)($setup.chatList, function (item, index) {\n            return (0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"div\", {\n              \"class\": \"chat-item\",\n              key: item.id\n            }, [item.showTime ? ((0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"div\", _hoisted_3, (0, _vue.toDisplayString)(item.addtime), 1 /* TEXT */)) : (0, _vue.createCommentVNode)(\"v-if\", true), item.ask ? ((0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"div\", _hoisted_4, [!item.img ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_alert, {\n              key: 0,\n              \"class\": \"text-content\",\n              title: item.ask,\n              closable: false,\n              type: \"success\"\n            }, null, 8 /* PROPS */, [\"title\"])) : item.ask.endsWith('.mp4') ? ((0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"video\", _hoisted_5, [(0, _vue.createElementVNode)(\"source\", {\n              src: _ctx.$config.url + item.ask\n            }, null, 8 /* PROPS */, _hoisted_6)])) : (0, _vue.createCommentVNode)(\"v-if\", true), item.img ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_image, {\n              key: 2,\n              src: _ctx.$config.url + item.img,\n              \"class\": \"chat_img\",\n              fit: \"scale-down\",\n              \"preview-src-list\": [_ctx.$config.url + item.img]\n            }, null, 8 /* PROPS */, [\"src\", \"preview-src-list\"])) : (0, _vue.createCommentVNode)(\"v-if\", true)])) : ((0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"div\", _hoisted_7, [!item.img ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_alert, {\n              key: 0,\n              \"class\": \"text-content\",\n              title: item.reply,\n              closable: false,\n              type: \"warning\"\n            }, null, 8 /* PROPS */, [\"title\"])) : item.reply.endsWith('.mp4') ? ((0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"video\", _hoisted_8, [(0, _vue.createElementVNode)(\"source\", {\n              src: _ctx.$config.url + item.reply\n            }, null, 8 /* PROPS */, _hoisted_9)])) : (0, _vue.createCommentVNode)(\"v-if\", true), item.img ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_el_image, {\n              key: 2,\n              src: _ctx.$config.url + item.img,\n              \"class\": \"chat_img\",\n              fit: \"scale-down\",\n              \"preview-src-list\": [_ctx.$config.url + item.img]\n            }, null, 8 /* PROPS */, [\"src\", \"preview-src-list\"])) : (0, _vue.createCommentVNode)(\"v-if\", true)])), _hoisted_10]);\n          }), 128 /* KEYED_FRAGMENT */))]), (0, _vue.createElementVNode)(\"div\", _hoisted_11, [(0, _vue.createVNode)(_component_el_input, {\n            \"class\": \"input\",\n            modelValue: $setup.form.reply,\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n              return $setup.form.reply = $event;\n            }),\n            placeholder: \"Please reply\",\n            type: \"textarea\"\n          }, null, 8 /* PROPS */, [\"modelValue\"]), (0, _vue.createElementVNode)(\"img\", {\n            src: \"http://chy2.gdnxeco.com/20230912/f60a0c39a6d34289b50c151949711b67.png\",\n            \"class\": \"inp_add\",\n            onClick: _cache[2] || (_cache[2] = function ($event) {\n              return $setup.askType = !$setup.askType;\n            }),\n            alt: \"\"\n          })]), $setup.askType ? ((0, _vue.openBlock)(), (0, _vue.createElementBlock)(\"div\", _hoisted_12, [(0, _vue.createVNode)(_component_el_upload, {\n            \"class\": \"upload-demo\",\n            action: $setup.action,\n            \"on-success\": $setup.uploadSuccess,\n            \"show-file-list\": false,\n            accept: \"image/*,.mp4\"\n          }, {\n            \"default\": (0, _vue.withCtx)(function () {\n              return [(0, _vue.createVNode)(_component_el_button, {\n                type: \"primary\"\n              }, {\n                \"default\": (0, _vue.withCtx)(function () {\n                  return [(0, _vue.createTextVNode)(\"Upload files\")];\n                }),\n                _: 1 /* STABLE */\n              })];\n            }),\n\n            _: 1 /* STABLE */\n          }, 8 /* PROPS */, [\"action\"])])) : (0, _vue.createCommentVNode)(\"v-if\", true), (0, _vue.createElementVNode)(\"div\", _hoisted_13, [(0, _vue.createVNode)(_component_el_button, {\n            type: \"primary\",\n            onClick: $setup.replySave\n          }, {\n            \"default\": (0, _vue.withCtx)(function () {\n              return [(0, _vue.createTextVNode)(\"Send\")];\n            }),\n            _: 1 /* STABLE */\n          })])];\n        }),\n\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"model\"])];\n    }),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"])])]);\n}","map":{"version":3,"mappings":"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","names":["controls","style","_hoisted_1","_component_el_table","data","$setup","border","stripe","_component_el_table_column","prop","resizable","sortable","align","label","scope","row","ask","isreply","_component_el_tag","type","_component_el_button","onClick","_component_el_pagination","background","layout","join","total","limit","page","onSizeChange","onCurrentChange","_component_el_dialog","title","width","onClose","_component_el_form","ref","model","_hoisted_2","_Fragment","item","index","key","id","showTime","_hoisted_3","addtime","_hoisted_4","img","_component_el_alert","closable","endsWith","_hoisted_5","src","_ctx","url","_component_el_image","fit","_hoisted_7","reply","_hoisted_8","_hoisted_10","_hoisted_11","_component_el_input","placeholder","alt","_hoisted_12","_component_el_upload","action","accept","_hoisted_13"],"sourceRoot":"","sources":["C:\\Users\\24831\\Desktop\\Y\\毕业设计\\projectB\\迭代2\\manage_code\\src\\views\\chat\\list.vue"],"sourcesContent":["<template>\r\n\t<div>\r\n\t\t<div class=\"center_view\">\r\n\t\t\t<el-table v-loading=\"listLoading\" :data=\"list\" border\r\n\t\t\t\t:stripe='false'>\r\n\t\t\t\t<el-table-column prop=\"ask\" :resizable='true' :sortable='true' align=\"left\" header-align=\"left\" label=\"new message\">\r\n\t\t\t\t\t<template #default=\"scope\">\r\n\t\t\t\t\t\t{{scope.row.ask}}\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t\t<el-table-column prop=\"ask\" :resizable='true' :sortable='true' align=\"left\" header-align=\"left\" label=\"state\">\r\n\t\t\t\t\t<template #default=\"scope\">\r\n\t\t\t\t\t\t<el-tag v-if=\"scope.row.isreply==1\" type=\"success\">No response received</el-tag>\r\n\t\t\t\t\t\t<el-tag v-if=\"scope.row.isreply==0\" type=\"info\">Replied</el-tag>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t\t<el-table-column prop=\"ask\" :resizable='true' :sortable='true' align=\"left\" header-align=\"left\" label=\"operate\">\r\n\t\t\t\t\t<template #default=\"scope\">\r\n\t\t\t\t\t\t<el-button class=\"edit_btn\" type=\"primary\" @click=\"replyClick(scope.row)\">Reply</el-button>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-table-column>\r\n\t\t\t</el-table>\r\n\t\t\t<el-pagination\r\n\t\t\t\tbackground\r\n\t\t\t\t:layout=\"layouts.join(',')\"\r\n\t\t\t\t:total=\"total\" \r\n\t\t\t\t:page-size=\"listQuery.limit\"\r\n                v-model:current-page=\"listQuery.page\"\r\n\t\t\t\tprev-text=\"Previous page\"\r\n\t\t\t\tnext-text=\"Next page\"\r\n\t\t\t\t:hide-on-single-page=\"false\"\r\n\t\t\t\t:style='{}'\r\n\t\t\t\t@size-change=\"sizeChange\"\r\n\t\t\t\t@current-change=\"currentChange\"  />\r\n\t\t\t<el-dialog v-model=\"formVisible\" title=\"Reply\" width=\"70%\" destroy-on-close @close=\"delTimer\">\r\n\t\t\t\t<el-form ref=\"formRef\" :model=\"form\" class=\"chat_view\">\r\n\t\t\t\t\t<div class=\"chat-content\">\r\n\t\t\t\t\t\t<div class=\"chat-item\" :key=\"item.id\" v-for=\"(item,index) in chatList\">\r\n\t\t\t\t\t\t\t<div class=\"chat_time\" v-if=\"item.showTime\">{{item.addtime}}</div>\r\n\t\t\t\t\t\t\t<div v-if=\"item.ask\" class=\"left-content\">\r\n\t\t\t\t\t\t\t\t<el-alert v-if=\"!item.img\" class=\"text-content\" :title=\"item.ask\" :closable=\"false\"\r\n\t\t\t\t\t\t\t\t\ttype=\"success\"></el-alert>\r\n                                <video v-else-if=\"item.ask.endsWith('.mp4')\" controls style=\"width: 200px;height: 160px\">\r\n                                    <source  :src=\"$config.url + item.ask\">\r\n                                </video>\r\n\t\t\t\t\t\t\t\t<el-image v-if=\"item.img\" :src=\"$config.url + item.img\"\r\n\t\t\t\t\t\t\t\t\tclass=\"chat_img\" fit=\"scale-down\"\r\n\t\t\t\t\t\t\t\t\t:preview-src-list=\"[$config.url + item.img]\"></el-image>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div v-else class=\"right-content\">\r\n\t\t\t\t\t\t\t\t<el-alert v-if=\"!item.img\" class=\"text-content\" :title=\"item.reply\" :closable=\"false\"\r\n\t\t\t\t\t\t\t\t\ttype=\"warning\"></el-alert>\r\n                                <video v-else-if=\"item.reply.endsWith('.mp4')\" controls style=\"width: 200px;height: 160px\">\r\n                                    <source  :src=\"$config.url + item.reply\">\r\n                                </video>\r\n\t\t\t\t\t\t\t\t<el-image v-if=\"item.img\" :src=\"$config.url + item.img\"\r\n\t\t\t\t\t\t\t\t\tclass=\"chat_img\" fit=\"scale-down\"\r\n\t\t\t\t\t\t\t\t\t:preview-src-list=\"[$config.url + item.img]\"></el-image>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div class=\"clear-float\"></div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"input_box\">\r\n\t\t\t\t\t\t<el-input class=\"input\" v-model=\"form.reply\" placeholder=\"Please reply\" type=\"textarea\" />\r\n\t\t\t\t\t\t<img src=\"http://chy2.gdnxeco.com/20230912/f60a0c39a6d34289b50c151949711b67.png\" class=\"inp_add\"\r\n\t\t\t\t\t\t\t@click=\"askType=!askType\" alt=\"\">\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"upload_box\" v-if=\"askType\">\r\n\t\t\t\t\t\t<el-upload class=\"upload-demo\" :action=\"action\" :on-success=\"uploadSuccess\"\r\n\t\t\t\t\t\t\t:show-file-list=\"false\" accept=\"image/*,.mp4\">\r\n\t\t\t\t\t\t\t<el-button type=\"primary\">Upload files</el-button>\r\n\t\t\t\t\t\t</el-upload>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"save_box\">\r\n\t\t\t\t\t\t<el-button type=\"primary\" @click=\"replySave\">Send</el-button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</el-form>\r\n\t\t\t</el-dialog>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\treactive,\r\n\t\tref,\r\n\t\tgetCurrentInstance,\r\n\t\tnextTick,\r\n\t\tonMounted,\r\n\t} from 'vue'\r\n    import moment from \"moment\"\r\n\tconst context = getCurrentInstance()?.appContext.config.globalProperties;\r\n\tconst list = ref([])\r\n\tconst listQuery = ref({\r\n\t\tpage: 1,\r\n\t\tlimit: 20,\r\n\t\tsort: 'id',\r\n\t\torder: 'desc',\r\n\t\tisreply: 1\r\n\t})\r\n\tconst listLoading = ref(false)\r\n\t//获取列表\r\n\tconst getList = () => {\r\n\t\tlet params = listQuery.value\r\n\t\tlistLoading.value = true\r\n\t\tcontext?.$http({\r\n\t\t\turl: 'chat/page',\r\n\t\t\tmethod: 'get',\r\n\t\t\tparams: params\r\n\t\t}).then(res => {\r\n\t\t\tlistLoading.value = false\r\n\t\t\tlist.value = res.data.data.list\r\n\t\t\ttotal.value = Number(res.data.data.total)\r\n\t\t})\r\n\t}\r\n\t//分页\r\n\tconst total = ref(0)\r\n\tconst layouts = ref([\"total\",\"prev\",\"pager\",\"next\",\"sizes\",\"jumper\"])\r\n\tconst sizeChange = (size) => {\r\n\t\tlistQuery.value.limit = size\r\n\t\tgetList()\r\n\t}\r\n\tconst currentChange = (page) => {\r\n\t\tlistQuery.value.page = page\r\n\t\tgetList()\r\n\t}\r\n\t//分页\r\n\t//form\r\n\tconst formVisible = ref(false)\r\n\tconst nowId = ref(0)\r\n\tconst form = ref({\r\n\t\treply: '',\r\n        isreply: 0,\r\n\t})\r\n\t//对话列表\r\n\tconst chatList = ref([])\r\n\t//回复按钮\r\n\tconst replyClick = (row) => {\r\n\t\tnowId.value = row.userid\r\n\t\tgetChatList()\r\n\t\tformVisible.value = true\r\n\t\ttimer.value = setInterval(() => {\r\n\t\t\tgetChatList()\r\n\t\t}, 3000)\r\n\t}\r\n\t//定时器\r\n\tconst timer = ref(null)\r\n\tconst delTimer = () => {\r\n\t\tclearInterval(timer.value)\r\n\t}\r\n    const scrollFlag = ref(true)\r\n\tconst getChatList = () => {\r\n\t\tcontext?.$http({\r\n\t\t\turl: 'chat/page',\r\n\t\t\tmethod: 'get',\r\n\t\t\tparams: {\r\n\t\t\t\tlimit: 1000,\r\n\t\t\t\tsort: 'addtime',\r\n\t\t\t\torder: 'asc',\r\n\t\t\t\tuserid: nowId.value\r\n\t\t\t}\r\n\t\t}).then(res => {\r\n\t\t\tfor (let x in res.data.data.list) {\r\n\t\t\t\tif (res.data.data.list[x].ask) {\r\n\t\t\t\t\tif (res.data.data.list[x].ask.split('/').length > 1) {\r\n\t\t\t\t\t\tif (res.data.data.list[x].ask.split('/')[0] == 'file') {\r\n\t\t\t\t\t\t\tres.data.data.list[x].img = res.data.data.list[x].ask\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (res.data.data.list[x].reply) {\r\n\t\t\t\t\tif (res.data.data.list[x].reply.split('/').length > 1) {\r\n\t\t\t\t\t\tif (res.data.data.list[x].reply.split('/')[0] == 'file') {\r\n\t\t\t\t\t\t\tres.data.data.list[x].img = res.data.data.list[x].reply\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(x==0){\r\n\t\t\t\t\tres.data.data.list[x].showTime = 1\r\n\t\t\t\t}else{\r\n\t\t\t\t\tlet jian = new Date(res.data.data.list[x].addtime).getTime() - new Date(res.data.data.list[x-1].addtime).getTime()\r\n\t\t\t\t\tif(jian>18000){\r\n\t\t\t\t\t\tres.data.data.list[x].showTime = 1\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tres.data.data.list[x].showTime = 0\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tchatList.value = res.data.data.list\r\n\t\t\tnextTick(() => {\r\n\t\t\t\tlet div = document.getElementsByClassName('chat-content')[0]\r\n\t\t\t\tsetTimeout(() => {\r\n                    if (div){\r\n                        if(div.scrollTop+div.clientHeight==div.scrollHeight || scrollFlag.value){\r\n                            div.scrollTop = div.scrollHeight\r\n                            scrollFlag.value = false\r\n                        }\r\n                    }\r\n\t\t\t\t}, 100)\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\t//发送信息\r\n\tconst replySave = () => {\r\n\t\tform.value.userid = nowId.value\r\n\t\tif (form.value.reply) {\r\n\t\t\tcontext?.$http({\r\n\t\t\t\turl: 'chat/save',\r\n\t\t\t\tmethod: 'post',\r\n\t\t\t\tdata: form.value\r\n\t\t\t}).then(res => {\r\n\t\t\t\tcontext?.$toolUtil.message('Successfully sent', 'success', () => {\r\n\t\t\t\t\tgetChatList()\r\n\t\t\t\t\tform.value.reply = ''\r\n\r\n\t\t\t\t})\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\t//图片\r\n\tconst action = ref(`${context?.$config.name}/file/upload`)\r\n\tconst askType = ref(false)\r\n\tconst uploadSuccess = (e) => {\r\n\r\n\t\tlet params = {\r\n\t\t\treply: 'file/' + e.file,\r\n\t\t\tuserid: nowId.value\r\n\t\t}\r\n\t\tcontext?.$http({\r\n\t\t\turl: 'chat/save',\r\n\t\t\tmethod: 'post',\r\n\t\t\tdata: params\r\n\t\t}).then(res => {\r\n\t\t\tcontext?.$toolUtil.message('Successfully sent', 'success', () => {\r\n\t\t\t\tgetChatList()\r\n\t\t\t\tform.value.reply = ''\r\n\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\tconst init = () => {\r\n\t\tgetList()\r\n\t}\r\n\tinit()\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n\t// 表格样式\r\n\t.el-table {\r\n\t\t:deep(.el-table__header-wrapper) {\r\n\t\t\tthead {\r\n\t\t\t\ttr {\r\n\t\t\t\t\tth {\r\n\t\t\t\t\t\t.cell {\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t:deep(.el-table__body-wrapper) {\r\n\t\t\ttbody {\r\n\t\t\t\ttr {\r\n\t\t\t\t\ttd {\r\n\t\t\t\t\t\t.cell {\r\n\t\t\t\t\t\t\t// 回复\r\n\t\t\t\t\t\t\t.el-button--primary {\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// 回复-悬浮\r\n\t\t\t\t\t\t\t.el-button--primary:hover {\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\ttr:hover {\r\n\t\t\t\t\ttd {\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t// 分页器\r\n\t.el-pagination {\r\n\t\t// 总页码\r\n\t\t:deep(.el-pagination__total) {\r\n\t\t}\r\n\t\t// 上一页\r\n\t\t:deep(.btn-prev) {\r\n\t\t}\r\n\t\t// 下一页\r\n\t\t:deep(.btn-next) {\r\n\t\t}\r\n\t\t// 上一页禁用\r\n\t\t:deep(.btn-prev:disabled) {\r\n\t\t}\r\n\t\t// 下一页禁用\r\n\t\t:deep(.btn-next:disabled) {\r\n\t\t}\r\n\t\t// 页码\r\n\t\t:deep(.el-pager) {\r\n\t\t\t// 数字\r\n\t\t\t.number {\r\n\t\t\t}\r\n\t\t\t// 数字悬浮\r\n\t\t\t.number:hover {\r\n\t\t\t}\r\n\t\t\t// 选中\r\n\t\t\t.number.active {\r\n\t\t\t}\r\n\t\t}\r\n\t\t// sizes\r\n\t\t:deep(.el-pagination__sizes) {\r\n\t\t\tdisplay: inline-block;\r\n\t\t\tvertical-align: top;\r\n\t\t\tfont-size: 13px;\r\n\t\t\tline-height: 28px;\r\n\t\t\theight: 28px;\r\n\t\t\t.el-select {\r\n\t\t\t}\r\n\t\t}\r\n\t\t// 跳页\r\n\t\t:deep(.el-pagination__jump) {\r\n\t\t\t// 输入框\r\n\t\t\t.el-input {\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t// 聊天总盒子\r\n\t.chat_view {\r\n\t\t// 聊天内容盒子\r\n\t\t.chat-content {\r\n\t\t\t// 聊天时间\r\n\t\t\t.chat_time{\r\n\t\t\t}\r\n\t\t\t// 提问盒子\r\n\t\t\t.left-content {\r\n\t\t\t\t// 文字样式\r\n\t\t\t\t:deep(.el-alert--success){\r\n\t\t\t\t\t.el-alert__title {\r\n\t\t\t\t\t\tfont-size: inherit;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// 聊天图片\r\n\t\t\t\t.chat_img {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// 回复盒子\r\n\t\t\t.right-content {\r\n\t\t\t\t// 文字样式\r\n\t\t\t\t:deep(.el-alert--warning){\r\n\t\t\t\t\t.el-alert__title {\r\n\t\t\t\t\t\tfont-size: inherit;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// 聊天图片\r\n\t\t\t\t.chat_img {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// 输入内容盒子\r\n\t\t.input_box{\r\n\t\t\t// 输入框\r\n\t\t\t:deep(.el-textarea__inner) {\r\n\t\t\t}\r\n\t\t\t// 操作按钮\r\n\t\t\t.inp_add {\r\n\t\t\t}\r\n\t\t}\r\n\t\t// 操作盒子\r\n\t\t.upload_box {\r\n\t\t\t:deep(.upload-demo) {\r\n\t\t\t\t// 按钮\r\n\t\t\t\t.el-button--primary {\r\n\t\t\t\t}\r\n\t\t\t\t// 按钮悬浮\r\n\t\t\t\t.el-button--primary:hover {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// 发送盒子\r\n\t\t.save_box {\r\n\t\t\t// 按钮\r\n\t\t\t:deep(.el-button--primary) {\r\n\t\t\t}\r\n\t\t\t// 按钮悬浮\r\n\t\t\t:deep(.el-button--primary:hover) {\r\n\t\t\t}\r\n\t\t}\r\n\t\t.clear-float {\r\n\t\t\tclear: both;\r\n\t\t}\r\n\t}\r\n</style>\r\n<style>\r\n.el-dialog{\r\n    width: 50% !important;\r\n}\r\n/* 总盒子 */\r\n.chat_view {\r\n    display: flex;\r\n    flex-direction: column;\r\n    margin: 30px 0px;\r\n    padding: 0px;\r\n    background: rgb(255, 255, 255);\r\n    border: 0px solid rgb(221, 221, 221);\r\n    border-radius: 4px;\r\n    font-size: 16px;\r\n}\r\n/* 聊天列表 盒子 */\r\n.chat_view .chat-content{\r\n    margin: 0px 0px 30px;\r\n    padding: 0px 0px 30px;\r\n    max-height: 300px;\r\n    height: 300px;\r\n    overflow-y: scroll;\r\n    border: 1px solid rgb(221, 221, 221) !important;\r\n    background: rgb(255, 255, 255) !important;\r\n    border-radius: 0px;\r\n}\r\n/* 时间 */\r\n.chat_view .chat-content .chat-item .chat_time{\r\n    width: 100%;\r\n    text-align: center;\r\n    font-size: 16px;\r\n    color: rgb(153, 153, 153);\r\n    padding: 6px 0px;\r\n}\r\n/* 提问 盒子 */\r\n.chat_view .chat-content .chat-item .left-content{\r\n    float: left;\r\n    margin: 0px 0px 10px;\r\n    padding: 10px;\r\n}\r\n/* 内容 */\r\n.chat_view .chat-content .chat-item .left-content .text-content{\r\n    background-color: rgb(240, 249, 235);\r\n    color: rgb(103, 194, 58);\r\n}\r\n/* 图片 */\r\n.chat_view .chat-content .chat-item .left-content .chat_img{\r\n    width: 120px;\r\n    margin: 10px;\r\n}\r\n/* 回复 盒子 */\r\n.chat_view .chat-content .chat-item .right-content{\r\n    float: right;\r\n    margin: 0px 0px 10px;\r\n    padding: 10px;\r\n}\r\n/* 内容 */\r\n.chat_view .chat-content .chat-item .right-content .text-content{\r\n    background-color: rgb(253, 246, 236);\r\n    color: rgb(230, 162, 60);\r\n}\r\n/* 图片 */\r\n.chat_view .chat-content .chat-item .right-content .chat_img{\r\n    width: 120px;\r\n    margin: 10px;\r\n}\r\n\r\n/* 操作栏 盒子 */\r\n.chat_view .input_box{\r\n    display: flex;\r\n    align-items: center;\r\n}\r\n/* 输入框 盒子 */\r\n.chat_view .input_box .el-textarea{\r\n    position: relative;\r\n    display: inline-block;\r\n    width: 100%;\r\n    vertical-align: bottom;\r\n    font-size: 14px;\r\n}\r\n/* 输入框 */\r\n.chat_view .input_box .el-textarea .el-textarea__inner{\r\n    min-height: 120px !important;\r\n}\r\n/* 加号 */\r\n.chat_view .input_box .inp_add{\r\n    width: 36px;\r\n    cursor: pointer;\r\n    margin: 0px 0px 0px 10px;\r\n}\r\n\r\n/* 上传 盒子 */\r\n.chat_view .upload_box{\r\n    display: flex;\r\n    align-items: center;\r\n    width: 100%;\r\n    justify-content: space-around;\r\n    margin: 20px 0px 0px;\r\n}\r\n/* 按钮 */\r\n.chat_view .upload_box .el-button--primary{\r\n    margin: 0px 10px 0px 0px;\r\n    padding: 0px 24px;\r\n    width: auto;\r\n    height: 36px;\r\n    font-size: 14px;\r\n    color: rgb(255, 255, 255);\r\n    border-radius: 0px;\r\n    border: 0px solid rgb(252, 203, 130);\r\n    background: rgb(59, 182, 43);\r\n    cursor: pointer;\r\n}\r\n/* 悬浮 */\r\n.chat_view .upload_box .el-button--primary:hover{\r\n}\r\n\r\n/* 按钮 盒子 */\r\n.chat_view .save_box{\r\nwidth: 100%;\r\n    display: flex;\r\n    margin: 10px 0px 0px;\r\n}\r\n/* 按钮 */\r\n.chat_view .save_box .el-button--primary{\r\n    margin: 0px 10px 0px 0px;\r\n    padding: 0px 24px;\r\n    width: auto;\r\n    height: 36px;\r\n    font-size: 14px;\r\n    color: rgb(255, 255, 255);\r\n    border-radius: 0px;\r\n    border: 0px solid rgb(252, 203, 130);\r\n    background: var(--theme);\r\n    cursor: pointer;\r\n    min-width: 110px;\r\n}\r\n/* 悬浮 */\r\n.chat_view .save_box .el-button--primary:hover{\r\n}\r\n\r\n</style>"]},"metadata":{},"sourceType":"script","externalDependencies":[]}