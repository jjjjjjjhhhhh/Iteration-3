{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\nvar _interopRequireDefault = require(\"C:/Users/24831/Desktop/Y/\\u6BD5\\u4E1A\\u8BBE\\u8BA1/projectB/\\u8FED\\u4EE32/manage_code/node_modules/@babel/runtime/helpers/interopRequireDefault.js\")[\"default\"];\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nrequire(\"core-js/modules/es.array.push.js\");\nrequire(\"core-js/modules/es.json.stringify.js\");\nvar _regeneratorRuntime2 = _interopRequireDefault(require(\"C:/Users/24831/Desktop/Y/\\u6BD5\\u4E1A\\u8BBE\\u8BA1/projectB/\\u8FED\\u4EE32/manage_code/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\"));\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"C:/Users/24831/Desktop/Y/\\u6BD5\\u4E1A\\u8BBE\\u8BA1/projectB/\\u8FED\\u4EE32/manage_code/node_modules/@babel/runtime/helpers/asyncToGenerator.js\"));\nvar _toolUtil = _interopRequireDefault(require(\"@/utils/toolUtil.js\"));\nvar _config = _interopRequireDefault(require(\"@/utils/config.js\"));\nvar _http = _interopRequireDefault(require(\"@/utils/http.js\"));\nvar _avatar = _interopRequireDefault(require(\"@/assets/img/avatar.png\"));\nvar _index = _interopRequireDefault(require(\"@/router/index\"));\nvar _default = {\n  namespaced: true,\n  state: {\n    session: {},\n    username: '管理员',\n    avatar: ''\n  },\n  getters: {\n    session: function session(state) {\n      if (!state.session.id) {\n        return _toolUtil[\"default\"].storageGet('back_session') ? JSON.parse(_toolUtil[\"default\"].storageGet('back_session')) : {};\n      }\n      return state.session;\n    },\n    avatar: function avatar(state) {\n      var key;\n      if (_toolUtil[\"default\"].storageGet('sessionTable') == 'yonghu') {\n        key = 'touxiang';\n      }\n      if (_toolUtil[\"default\"].storageGet('sessionTable') == 'jiankangzhuanjia') {\n        key = 'touxiang';\n      }\n      var avatar = state.session[key];\n      state.avatar = avatar;\n      return avatar ? _config[\"default\"].get().url + avatar : _avatar[\"default\"];\n    }\n  },\n  actions: {\n    getSession: function getSession(_ref) {\n      return (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/(0, _regeneratorRuntime2[\"default\"])().mark(function _callee() {\n        var commit, sessionTable, res;\n        return (0, _regeneratorRuntime2[\"default\"])().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              commit = _ref.commit;\n              sessionTable = _toolUtil[\"default\"].storageGet('sessionTable');\n              if (sessionTable) {\n                _context.next = 5;\n                break;\n              }\n              _index[\"default\"].push('/login');\n              return _context.abrupt(\"return\");\n            case 5:\n              _context.next = 7;\n              return _http[\"default\"].get(\"\".concat(sessionTable, \"/session\"));\n            case 7:\n              res = _context.sent;\n              if (res.data.code == 0) {\n                localStorage.setItem('admin_userid', res.data.data.id);\n                commit('set_session', res.data.data);\n              }\n              return _context.abrupt(\"return\", res);\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }))();\n    },\n    update: function update(_ref2, data) {\n      return (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/(0, _regeneratorRuntime2[\"default\"])().mark(function _callee2() {\n        var commit, res;\n        return (0, _regeneratorRuntime2[\"default\"])().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              commit = _ref2.commit;\n              _context2.next = 3;\n              return _http[\"default\"].post(\"\".concat(_toolUtil[\"default\"].storageGet('sessionTable'), \"/update\"), data);\n            case 3:\n              res = _context2.sent;\n              if (res.data.code == 0) {\n                commit('assign_session', data);\n              }\n              return _context2.abrupt(\"return\", res);\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2);\n      }))();\n    },\n    loginOut: function loginOut(_ref3, data) {\n      return (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/(0, _regeneratorRuntime2[\"default\"])().mark(function _callee3() {\n        var commit;\n        return (0, _regeneratorRuntime2[\"default\"])().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              commit = _ref3.commit;\n              commit('loginOut');\n            case 2:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3);\n      }))();\n    }\n  },\n  mutations: {\n    set_session: function set_session(state, data) {\n      state.session = data;\n      _toolUtil[\"default\"].storageSet('back_session', JSON.stringify(state.session));\n    },\n    assign_session: function assign_session(state, data) {\n      Object.assign(state.session, JSON.parse(JSON.stringify(data)));\n      _toolUtil[\"default\"].storageSet('back_session', JSON.stringify(state.session));\n    },\n    loginOut: function loginOut(state, data) {\n      state.session = {}, state.username = '管理员', state.avatar = '';\n    }\n  }\n};\nexports[\"default\"] = _default;","map":{"version":3,"names":["namespaced","state","session","username","avatar","getters","id","toolUtil","storageGet","JSON","parse","key","config","get","url","default_avatar","actions","getSession","commit","sessionTable","router","push","http","res","data","code","localStorage","setItem","update","post","loginOut","mutations","set_session","storageSet","stringify","assign_session","Object","assign"],"sources":["C:/Users/24831/Desktop/Y/毕业设计/projectB/迭代2/manage_code/src/store/modules/user.js"],"sourcesContent":["import toolUtil from '@/utils/toolUtil.js'\r\nimport config from '@/utils/config.js'\r\nimport http from '@/utils/http.js'\r\nimport default_avatar from \"@/assets/img/avatar.png\"\r\nimport router from '@/router/index'\r\n\r\nexport default {\r\n    namespaced: true,\r\n    state:{\r\n        session:{},\r\n        username:'管理员',\r\n        avatar:''\r\n    },\r\n    getters:{\r\n        session(state){\r\n            if(!state.session.id){\r\n                return toolUtil.storageGet('back_session')?JSON.parse(toolUtil.storageGet('back_session')):{}\r\n            }\r\n            return state.session\r\n        },\r\n        avatar(state){\r\n            let key;\r\n            if(toolUtil.storageGet('sessionTable') == 'yonghu'){\r\n                key = 'touxiang'\r\n            }\r\n            if(toolUtil.storageGet('sessionTable') == 'jiankangzhuanjia'){\r\n                key = 'touxiang'\r\n            }\r\n            let avatar = state.session[key]\r\n            state.avatar = avatar\r\n            return avatar?config.get().url+avatar:default_avatar\r\n        },\r\n    },\r\n    actions:{\r\n        async getSession({commit}){\r\n            let sessionTable = toolUtil.storageGet('sessionTable')\r\n            if(!sessionTable){\r\n                router.push('/login')\r\n                return\r\n            }\r\n            let res = await http.get(`${sessionTable}/session`)\r\n            if(res.data.code==0){\r\n                localStorage.setItem('admin_userid',res.data.data.id)\r\n                commit('set_session',res.data.data)\r\n            }\r\n            return res\r\n        },\r\n        async update({commit},data){\r\n            let res = await http.post(`${toolUtil.storageGet('sessionTable')}/update`,data)\r\n            if(res.data.code==0){\r\n                commit('assign_session',data)\r\n            }\r\n            return res\r\n        },\r\n        async loginOut({commit},data){\r\n            commit('loginOut')\r\n        }\r\n    },\r\n    mutations:{\r\n        set_session(state,data){\r\n            state.session = data\r\n            toolUtil.storageSet('back_session',JSON.stringify(state.session))\r\n        },\r\n        assign_session(state,data){\r\n            Object.assign(state.session,JSON.parse(JSON.stringify(data)))\r\n            toolUtil.storageSet('back_session',JSON.stringify(state.session))\r\n        },\r\n        loginOut(state,data){\r\n            state.session={},\r\n            state.username='管理员',\r\n            state.avatar=''\r\n        }\r\n    }\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}